@{
    ViewData["Title"] = "Login";
    ViewData["PageId"] = "Login";
    Layout = MVC.Views.Shared._LayoutSlim;
}

@section Head {
    @Html.Script("~/Scripts/vegas/vegas.js")
    <script type="text/javascript">@Html.Raw(DynamicScriptManager.GetScriptText("Form.Membership.Login"))</script>
    <script type="text/javascript">@Html.Raw(Html.GetLocalTextContent("Login"))</script>
    @Html.Stylesheet("~/Scripts/vegas/vegas.css")

    <style type="text/css">
        body {
          font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
          font-size: 13px;
          color: #000;
          -ms-overflow-style: scrollbar;
        }

        #LoginPanel {
            padding: 30px 20px;
            width: 550px;
            margin: 90px auto auto auto;
            background: rgba(0,0,0,0.5);
            border-radius: 12px;
            font-weight: 700;
        }

        #LoginPanel .caption {
            width: 180px;
        }

       #LoginPanel .logo {
            margin: 0 auto 20px auto;
            width: 128px;
            height: 128px;
            background: transparent url(data:image/png;base64,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) no-repeat center center;
        }

       #LoginPanel h3 {
            font-size: 18px;
            font-weight: 700;
            margin: 16px 0 24px;
            color: #f5f27e;
            text-align: center;
            text-shadow: 0 1px 1px #333;
        }

       #LoginPanel .buttons {
            text-align: right;
            padding: 8px 0 4px 0;
            margin-right: 28px;
        }

        #LoginPanel .btn {
                padding: 8px 24px;
                font-weight: 700;
        }

       #LoginPanel .caption {
            color: #ececec;
            font-weight: 700;
            text-shadow: 0 1px 1px #333;
        }

       #LoginPanel .actions {
            padding-right: 28px;
        }

        #LoginPanel .actions a {
            color: #ececec;
            padding: 2px 2px 2px 2px;
            margin-top: 5px;
            display: block;
            float: right;
            clear: both;
            border-bottom: 1px dashed #999;
            text-shadow: 0 1px 1px #333;
        }

        #LoginPanel .actions a i {
            font-weight: 700;
            margin-right: 4px;
        }

        #LoginPanel .s-Form label.error {
            background-image: url(@Url.Content("~/Content/serenity/images/cross.png"));
            padding: 26px 0 0 22px;
        }

        #LoginPanel .s-Form label.error.checked {
            background-image: none;
        }

        #LoginPanel .s-Form .field {
            padding: 8px;
        }

        #LoginPanel .s-Form input {
            padding: 6px 10px;
            border: none;
            background: rgba(0, 0, 0, 0.6);
            color: #fff;
        }

        #LoginPanel .s-Form .caption {
            padding: 6px 10px;
            color: #fff;
        }

        #LoginPanel a {
            color: aqua;
        }

        #LoginPanel .s-PropertyGrid .categories {
            height: auto;
        }

        #LoginPanel .flex-layout .s-PropertyGrid {
            display: block;
        }

        @@media(max-width: 550px), (max-height: 500px) {
            #LoginPanel {
                padding: 16px 4px 16px 4px;
                position: absolute;
                margin: 0;
                width: auto;
                top: 10px;
                left: 10px;
                right: 10px;
            }
        }
    </style>
}

<script id="Template_LoginPanel" type="text/template">
<div class="flex-layout">
    <div class="logo"></div>
    <h3>@Texts.Forms.Membership.Login.FormTitle</h3>
    <form id="~_Form" action="">
        <div class="s-Form">
            <div class="fieldset ui-widget ui-widget-content ui-corner-all">
                <div id="~_PropertyGrid"></div>
                <div class="clear"></div>
            </div>
            <div class="buttons">
                <button id="LoginButton" type="submit" class="btn btn-primary">
                    @Texts.Forms.Membership.Login.SignInButton
                </button>
            </div>
            <div class="actions">
                <a href="@Url.Content("~/Account/ForgotPassword")"><i class="fa fa-angle-right"></i>&nbsp;@Texts.Forms.Membership.Login.ForgotPassword</a>
                <a href="@Url.Content("~/Account/SignUp")"><i class="fa fa-angle-right"></i>&nbsp;@Texts.Forms.Membership.Login.SignUpButton</a>
                <div class="clear"></div>
            </div>
        </div>
    </form>
</div>
</script>

@if (DataMigrations.SkippedMigrations)
{
<div class="alert alert-error alert-dismissible">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
    <h4><i class="icon fa fa-warning"></i> Warning!</h4>
    Serene skipped running migrations to avoid modifying an arbitrary database.
    If you'd like to run migrations on this database, remove the safety check 
    in SiteInitialization.RunMigrations method.
</div>
}

@if (ViewData["Activated"] != null)
{
<div class="alert alert-info alert-dismissible">
    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
    <h4><i class="icon fa fa-info"></i>@LocalText.Get("Dialogs.InformationTitle")</h4>
    @Texts.Forms.Membership.SignUp.ActivationCompleteMessage
</div>
}

<div class="page-content">
    <div id="LoginPanel">

    </div>
</div>

<script type="text/javascript">

var LoginPanel = (function (_super) {
    __extends(LoginPanel, _super);
    function LoginPanel(container) {
        var _this = _super.call(this, container) || this;
        $(function () {
            $('body').vegas({
                delay: 30000,
                cover: true,
                overlay: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACAQMAAABIeJ9nAAAAA3NCSVQICAjb4U" +
                    "/gAAAABlBMVEX///8AAABVwtN+AAAAAnRSTlMA/1uRIrUAAAAJcEhZcwAAAsQAAALEAVuRnQsAAAAWdEVYdENyZWF0" +
                    "aW9uIFRpbWUAMDQvMTMvMTGrW0T6AAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M1cbXjNgAAAAxJREFUCJljaGBgAAABhACBrONIPgAAAABJRU5ErkJggg==",
                slides: [
                    { src: @Html.Raw(ContentHashCache.ResolveWithHash("~/Content/site/slides/slide1.jpg").ToJson()), transition: 'fade' },
                    { src: @Html.Raw(ContentHashCache.ResolveWithHash("~/Content/site/slides/slide2.jpg").ToJson()), transition: 'zoomOut' },
                    { src: @Html.Raw(ContentHashCache.ResolveWithHash("~/Content/site/slides/slide3.jpg").ToJson()), transition: 'swirlLeft' }
                ]
            });
            $('#LoginButton').click(function (e) {
                e.preventDefault();
                if (!_this.validateForm()) {
                    return;
                }
                var request = _this.getSaveEntity();
                Q.serviceCall({
                    url: Q.resolveUrl('~/Account/Login'),
                    request: request,
                    onSuccess: function (response) {
                        var q = Q.parseQueryString();
                        var returnUrl = q['returnUrl'] || q['ReturnUrl'];
                        if (returnUrl) {
                            var hash = window.location.hash;
                            if (hash != null && hash != '#')
                                returnUrl += hash;
                            window.location.href = returnUrl;
                        }
                        else {
                            window.location.href = Q.resolveUrl('~/');
                        }
                    }
                });
            });
        });
        return _this;
    }
    LoginPanel.prototype.getTemplateName = function () { return 'LoginPanel'; };
    LoginPanel.prototype.getFormKey = function () { return "Membership.Login"; };
    return LoginPanel;
}(Serenity.PropertyPanel));

jQuery(function() {
    new LoginPanel($('#LoginPanel')).init();

@if (ViewData["Activated"] != null)
{
    <text>
    $(function() { 
        $('#Username').val(@Html.Raw(Serenity.JSON.Stringify(ViewData["Activated"])));
        $('#Password').focus();
    });
    </text>
}
});
</script>
var __decorate=this&&this.__decorate||function(e,t,n,i){var r=arguments.length,a=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)if(o=e[s])a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a;return r>3&&a&&Object.defineProperty(t,n,a),a};var __extends=this&&this.__extends||function(e,t){for(var n in t)if(t.hasOwnProperty(n)&&n!=="__metadata")e[n]=t[n];function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)};if(typeof Promise==="undefined"){if(typeof RSVP!=="undefined"){Promise=RSVP}else if(typeof jQuery!=="undefined"){Promise=$.Deferred;Promise.resolve=function(e){return jQuery.Deferred().resolveWith(e)}}}var Q;(function(e){function t(e,t){return ss.coalesce(e,t)}e.coalesce=t;function n(e){return ss.isValue(e)}e.isValue=n;function i(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}var r,a,o,s,l,u,c=arguments[0]||{},f=1,d=arguments.length;if(typeof c!=="object"&&!$.isFunction(c)){c={}}if(f===d){c={};f=0}for(;f<d;f++){if((r=arguments[f])!==null){if($.isArray(r)){c=$.extend(true,[],r)}else{for(a in r){o=c[a];s=r[a];if(c===s){continue}if(s&&($.isPlainObject(s)||(l=$.isArray(s)))){if(l){l=false;u=o&&$.isArray(o)?o:[]}else{u=o&&$.isPlainObject(o)?o:{}}c[a]=i(u,s)}else if(s!==undefined){c[a]=s}}}}}return c}e.deepClone=i})(Q||(Q={}));var Q;(function(e){function t(e,t){for(var n=0,i=e;n<i.length;n++){var r=i[n];if(t(r))return true}return false}e.any=t;function n(e,t){var n=0;for(var i=0,r=e;i<r.length;i++){var a=r[i];if(t(a))n++}return n}e.count=n;function i(e,t){for(var n=0,i=e;n<i.length;n++){var r=i[n];if(t(r))return r}throw new Error("first:No element satisfies the condition.!")}e.first=i;function r(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}e.indexOf=r;function a(e,t,n){ss.insert(e,t,n)}e.insert=a;function o(e){return ss.isArray(e)}e.isArray=o;function s(e,t){var n;var i=false;for(var r=0,a=e;r<a.length;r++){var o=a[r];if(t(o)){if(i)throw new Error("single:sequence contains more than one element.");i=true;n=o}}if(!i)throw new Error("single:No element satisfies the condition.");return n}e.single=s;function l(e,t){var n={};for(var i=0,r=e;i<r.length;i++){var a=r[i];var o=t(a)||"";var s=n[o];if(!s){s=n[o]=[]}s.push(a)}return n}e.toGrouping=l;function u(e,t){for(var n=0,i=e;n<i.length;n++){var r=i[n];if(t(r))return r}}e.tryFirst=u})(Q||(Q={}));var Q;(function(e){function t(e,t){return ss.endsWithString(e,t)}e.endsWith=t;function n(e){return e==null||e.length===0}e.isEmptyOrNull=n;function i(e){return c(e)==null}e.isTrimmedEmpty=i;function r(e){var t=[];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}return(i=ss).formatString.apply(i,[e].concat(t));var i}e.format=r;function a(e,t,n){if(n===void 0){n=" "}while(e.length<t)e="0"+e;return e}e.padLeft=a;function o(e,t){return ss.startsWithString(e,t)}e.startsWith=o;function s(t){return e.replaceAll(e.replaceAll(u(t),"\r\n"," "),"\n"," ").trim()}e.toSingleLine=s;function l(e){return(e==null?"":e).replace(new RegExp("^\\s+|\\s+$","g"),"")}e.trim=l;function u(e){if(e==null||e.length===0){return""}return l(e)}e.trimToEmpty=u;function c(e){if(e==null||e.length===0){return null}e=l(e);if(e.length===0){return null}else{return e}}e.trimToNull=c;var f;function d(e,t){var n="AaBbCcÇçFfGgĞğHhIıİiJjKkLlMmNnOoÖöPpRrSsŞşTtUuÜüVvYyZz";e=e||"";t=t||"";if(e==t)return 0;if(!f){f={};for(var i=0;i<n.length;i++){f[n.charAt(i)]=i+1}}for(var r=0,a=Math.min(e.length,t.length);r<a;r++){var o=e.charAt(r),s=t.charAt(r);if(o===s)continue;var l=f[o],u=f[s];if(l!=null&&u!=null)return l<u?-1:1;var c=o.localeCompare(s);if(c==0)continue;return c}return e.localeCompare(t)}e.turkishLocaleCompare=d;function g(e){if(!e)return e;return e.replace(/i/g,"İ").replace(/ı/g,"I").toUpperCase()}e.turkishLocaleToUpper=g;function p(e,t,n){return ss.replaceAllString(e,t,n)}e.replaceAll=p;function h(e,t){var n=e.toString();while(n.length<t)n="0"+n;return n}e.zeroPad=h})(Q||(Q={}));var Q;(function(e){var t;(function(t){t.decimalSeparator=".";t.dateSeparator="/";t.dateOrder="dmy";t.dateFormat="dd/MM/yyyy";t.dateTimeFormat="dd/MM/yyyy HH:mm:ss";function n(){return t.decimalSeparator===","?".":","}t.get_groupSeperator=n;var i=e.trimToNull($("script#ScriptCulture").html());if(i!=null){var r=$.parseJSON(i);if(r.DecimalSeparator!=null)t.decimalSeparator=r.DecimalSeparator;if(r.DateSeparator!=null)t.dateSeparator=r.DateSeparator;if(r.DateOrder!=null)t.dateOrder=r.DateOrder;if(r.DateFormat!=null)t.dateFormat=r.DateFormat;if(r.DateTimeFormat!=null)t.dateTimeFormat=r.DateTimeFormat}})(t=e.Culture||(e.Culture={}))})(Q||(Q={}));var Q;(function(e){function t(t,n,i,r){var o="-";if(isNaN(t)){return null}i=i||e.Culture.decimalSeparator;r=r||e.Culture.get_groupSeperator();var s="";if(n.indexOf(".")>-1){var l=i;var u=n.substring(n.lastIndexOf(".")+1);t=a(t,u.length);var c=t%1;var f=new String(c.toFixed(u.length));f=f.substring(f.lastIndexOf(".")+1);for(var d=0;d<u.length;d++){if(u.charAt(d)=="#"&&f.charAt(d)!="0"){l+=f.charAt(d);continue}else if(u.charAt(d)=="#"&&f.charAt(d)=="0"){var g=f.substring(d);if(g.match("[1-9]")){l+=f.charAt(d);continue}else break}else if(u.charAt(d)=="0")l+=f.charAt(d);else l+=u.charAt(d)}s+=l}else t=Math.round(t);var p=Math.floor(t);if(t<0)p=Math.ceil(t);var h="";if(n.indexOf(".")==-1)h=n;else h=n.substring(0,n.indexOf("."));var v="";if(!(p==0&&h.substr(h.length-1)=="#")){var m=new String(Math.abs(p));var y=9999;if(h.lastIndexOf(",")!=-1)y=h.length-h.lastIndexOf(",")-1;var b=0;for(var d=m.length-1;d>-1;d--){v=m.charAt(d)+v;b++;if(b==y&&d!=0){v=r+v;b=0}}if(h.length>v.length){var w=h.indexOf("0");if(w!=-1){var C=h.length-w;var _=h.length-v.length-1;while(v.length<C){var $=h.charAt(_);if($==",")$=r;v=$+v;_--}}}}if(!v&&h.indexOf("0",h.length-1)!==-1)v="0";s=v+s;if(t<0)s=o+s;if(s.lastIndexOf(i)==s.length-1){s=s.substring(0,s.length-1)}return s}e.formatNumber=t;var n=/(\d{4,})(?:-(\d{1,2})(?:-(\d{1,2})(?:[T ](\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d+))?)?(?:(Z)|([+-])(\d{1,2})(?::(\d{1,2}))?)?)?)?)?/;function i(t){t=e.trim(t.toString());var n=e.Culture.get_groupSeperator();if(t&&t.length&&t.indexOf(n)>0){t=t.replace(new RegExp("(\\b\\d{1,3})\\"+n+"(?=\\d{3}(\\D|$))","g"),"$1")}if(!/^[-\+]?\d+$/.test(t))return NaN;return parseInt(t,10)}e.parseInteger=i;function r(t){if(t==null)return null;t=e.trim(t.toString());if(t.length==0)return null;var n=e.Culture.get_groupSeperator();if(t&&t.length&&t.indexOf(n)>0){t=t.replace(new RegExp("(\\b\\d{1,3})\\"+n+"(?=\\d{3}(\\D|$))","g"),"$1")}if(!new RegExp("^\\s*([-\\+])?(\\d*)\\"+e.Culture.decimalSeparator+"?(\\d*)\\s*$").test(t))return NaN;return parseFloat(t.toString().replace(e.Culture.decimalSeparator,"."))}e.parseDecimal=r;function a(e,t){var n=Math.pow(10,t||0);var i=(Math.round(e*n)/n).toString();if(t>0){var r=i.indexOf(".");if(r==-1){i+=".";r=0}else{r=i.length-(r+1)}while(r<t){i+="0";r++}}return parseFloat(i)}function o(e){if(e==null)return null;if(typeof e=="number")return e;e=$.trim(e);if(e==null||!e.length)return null;if(e.length>=15||!/^-?\d+$/.test(e))return e;var t=parseInt(e,10);if(isNaN(t))return e;return t}e.toId=o})(Q||(Q={}));var Q;(function(e){function t(t,n){if(!t){return""}var i;if(typeof t=="string"){var r=e.parseDate(t);if(!r)return t;i=r}else i=t;if(n==null||n=="d"){n=e.Culture.dateFormat}else{switch(n){case"g":n=e.Culture.dateTimeFormat.replace(":ss","");break;case"G":n=e.Culture.dateTimeFormat;break;case"s":n="yyyy-MM-ddTHH:mm:ss";break;case"u":return e.formatISODateTimeUTC(i)}}var a=function(t){return e.zeroPad(t,2)};return n.replace(new RegExp("dd?|MM?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|fff|zz?z?|\\/","g"),function(t){switch(t){case"/":return e.Culture.dateSeparator;case"hh":return a(i.getHours()<13?i.getHours():i.getHours()-12);case"h":return i.getHours()<13?i.getHours():i.getHours()-12;case"HH":return a(i.getHours());case"H":return i.getHours();case"mm":return a(i.getMinutes());case"m":return i.getMinutes();case"ss":return a(i.getSeconds());case"s":return i.getSeconds();case"yyyy":return i.getFullYear();case"yy":return i.getFullYear().toString().substr(2,4);case"dd":return a(i.getDate());case"d":return i.getDate().toString();case"MM":return a(i.getMonth()+1);case"M":return i.getMonth()+1;case"t":return i.getHours()<12?"A":"P";case"tt":return i.getHours()<12?"AM":"PM";case"fff":return e.zeroPad(i.getMilliseconds(),3);case"zzz":case"zz":case"z":return"";default:return t}})}e.formatDate=t;function n(t){if(t===0)return"0";else if(!t)return"";var n=Math.floor(t/24/60);var i="";if(n>0){i+=n.toString()}var r=e.zeroPad(Math.floor(t%(24*60)/60),2)+":"+e.zeroPad(t%60,2);if(r!="00:00"){if(n>0)i+=".";i+=r}return i}e.formatDayHourAndMin=n;function i(e){if(e==null)return"";var t=function(e){return(e<10?"0":"")+e};var n=e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes());var i=Number(e.getUTCSeconds()+"."+(e.getUTCMilliseconds()<100?"0":"")+t(e.getUTCMilliseconds()));n+=":"+t(i)+"Z";return n}e.formatISODateTimeUTC=i;var r=/(\d{4,})(?:-(\d{1,2})(?:-(\d{1,2})(?:[T ](\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d+))?)?(?:(Z)|([+-])(\d{1,2})(?::(\d{1,2}))?)?)?)?)?/;function a(e){if(!e||!e.length)return null;e=e+"";if(typeof e!="string"||e.length===0){return null}var t=e.match(r);if(typeof t=="undefined"||t===null){return null}var n,i,a,o,s,l,u;n=parseInt(t[1],10);if(typeof t[2]=="undefined"||t[2]===""){return new Date(n)}i=parseInt(t[2],10)-1;a=parseInt(t[3],10);if(typeof t[4]=="undefined"||t[4]===""){return new Date(n,i,a)}o=parseInt(t[4],10);s=parseInt(t[5],10);l=typeof t[6]!="undefined"&&t[6]!==""?parseInt(t[6],10):0;if(typeof t[7]!="undefined"&&t[7]!==""){u=Math.round(1e3*parseFloat("0."+t[7]))}else{u=0}if((typeof t[8]=="undefined"||t[8]==="")&&(typeof t[9]=="undefined"||t[9]==="")){return new Date(n,i,a,o,s,l,u)}var c;if(typeof t[9]!="undefined"&&t[9]!==""){c=parseInt(t[10],10)*36e5;if(typeof t[11]!="undefined"&&t[11]!==""){c+=parseInt(t[11],10)*6e4}if(t[9]=="-"){c=-c}}else{c=0}return new Date(Date.UTC(n,i,a,o,s,l,u)-c)}e.parseISODateTime=a;function o(t){var n=e.trim(t);if(n.length<4||n.length>5)return NaN;var i,r;if(n.charAt(1)==":"){i=e.parseInteger(n.substr(0,1));r=e.parseInteger(n.substr(2,2))}else{if(n.charAt(2)!=":")return NaN;i=e.parseInteger(n.substr(0,2));r=e.parseInteger(n.substr(3,2))}if(isNaN(i)||isNaN(r)||i<0||i>23||r<0||r>59)return NaN;return i*60+r}e.parseHourAndMin=o;function s(t){var n;var i=e.trim(t);if(!i)return NaN;var r=i.split(".");if(r.length==0||r.length>2)return NaN;if(r.length==1){n=e.parseInteger(r[0]);if(!isNaN(n))return n*24*60;return o(r[0])}else{n=e.parseInteger(r[0]);var a=o(r[1]);if(isNaN(n)||isNaN(a))return NaN;return n*24*60+a}}e.parseDayHourAndMin=s;function l(t,n){if(!t||!t.length)return null;if(t.length>=10&&t.charAt(4)==="-"&&t.charAt(7)==="-"&&(t.length===10||t.length>10&&t.charAt(10)==="T")){var i=e.parseISODateTime(t);if(i==null)return false;return i}var r;var a;var o,s,l;a=u(t);if(!a)return false;if(a.length==3){n=n||e.Culture.dateOrder;switch(n){case"dmy":o=parseInt(a[0],10);s=parseInt(a[1],10)-1;l=parseInt(a[2],10);break;case"ymd":o=parseInt(a[2],10);s=parseInt(a[1],10)-1;l=parseInt(a[0],10);break;case"mdy":default:o=parseInt(a[1],10);s=parseInt(a[0],10)-1;l=parseInt(a[2],10);break}if(isNaN(o)||isNaN(s)||isNaN(l)||o<1||o>31||s<0||s>11||l>9999||l<0)return false;if(l<100){var c=(new Date).getFullYear();var f=c%100+10;l+=c-c%100+(l<=f?0:-100)}try{r=new Date(l,s,o);if(isNaN(r.getFullYear()))return false}catch(d){return false}}else if(a.length==1){try{r=new Date(a[0]);if(isNaN(r.getFullYear()))return false}catch(d){return false}}return r}e.parseDate=l;function u(t){t=e.trim(t);if(!t.length)return;if(t.indexOf("/")>=0)return t.split("/");else if(t.indexOf(".")>=0)return t.split(".");else if(t.indexOf("-")>=0)return t.split("-");else if(t.indexOf("\\")>=0)return t.split("\\");else return[t]}e.splitDateString=u})(Q||(Q={}));var Q;(function(e){function t(e){var t=i.$table[e];if(t==null){t=e||""}return t}e.text=t;function n(e){return i.$table[e]}e.tryGetText=n;var i=function(){function e(e){this.key=e}e.add=function(t,n){if(!t){return}n=n||"";for(var i=0,r=Object.keys(t);i<r.length;i++){var a=r[i];var o=n+a;var s=t[a];if(typeof s==="object"){e.add(s,o+".")}else{e.$table[o]=s}}};e.prototype.get=function(){var t=e.$table[this.key];if(t==null){t=this.key||""}return t};e.prototype.toString=function(){var t=e.$table[this.key];if(t==null){t=this.key||""}return t};e.$table={};e.empty=new e("");e.initializeTextClass=function(t,n){var i=Object.keys(t).slice();for(var r=0;r<i.length;r++){var a=i[r];var o=t[a];if(o instanceof e){var s=o;var l=n+a;e.$table[l]=s.key;t[a]=new e(l)}}};e.getDefault=function(t,n){var i=e.$table[t];if(i==null){i=n;if(i==null){i=t||""}}return i};return e}();e.LT=i})(Q||(Q={}));var Q;(function(e){var t=function(){function t(e,t){this.items=[];this.itemById={};e=e||{};this.textFormatter=e.textFormatter;this.idField=e.idField;this.parentIdField=e.parentIdField;this.textField=e.textField;this.textFormatter=e.textFormatter;if(t!=null)this.update(t)}t.prototype.update=function(t){this.items=[];this.itemById={};if(t){for(var n=0,i=t;n<i.length;n++){var r=i[n];this.items.push(r)}}var a=this.idField;if(!e.isEmptyOrNull(a)){for(var o=0,s=this.items;o<s.length;o++){var l=s[o];var u=l[a];if(u!=null){this.itemById[u]=l}}}};t.prototype.get_idField=function(){return this.idField};t.prototype.get_parentIdField=function(){return this.parentIdField};t.prototype.get_textField=function(){return this.textField};t.prototype.get_textFormatter=function(){return this.textFormatter};t.prototype.get_itemById=function(){return this.itemById};t.prototype.get_items=function(){return this.items};return t}();e.Lookup=t})(Q||(Q={}));var Q;(function(e){var t=0;function n(e){if(t>0){t++;return}$.blockUI(e);t++}function i(e){e=$.extend({baseZ:2e3,message:"",overlayCSS:{opacity:"0.0",zIndex:2e3,cursor:"wait"},fadeOut:0},e);if(e.useTimeout){window.setTimeout(function(){n(e)},0)}else{n(e)}}e.blockUI=i;function r(){if(t>1){t--;return}t--;$.unblockUI({fadeOut:0})}e.blockUndo=r})(Q||(Q={}));var Q;(function(e){function t(e,t,n){$("<option/>").val(t).text(n).appendTo(e)}e.addOption=t;function n(n){t(n,"",e.text("Controls.SelectEditor.EmptyItemText"))}e.addEmptyOption=n;function i(e){e.html("")}e.clearOptions=i;function r(t,n){var i=t.attr("id");if(e.isEmptyOrNull(i)){return $("#"+n)}var r=$("#"+i+n);if(r.length>0){return r}r=$("#"+i+"_"+n);if(r.length>0){return r}while(true){var a=i.lastIndexOf("_");if(a<=0){return $("#"+n)}i=i.substr(0,a);r=$("#"+i+"_"+n);if(r.length>0){return r}}}e.findElementWithRelativeId=r;function a(e){switch(e){case"&":return"&amp;";case">":return"&gt;";case"<":return"&lt;";case"'":return"&apos;";case'"':return"&quot;"}return e}var o=/[><&'"]/g;function s(e){var t=e==null?"":e.toString();if(o.test(t)){return t.replace(o,a)}return t}e.attrEncode=s;function l(e){switch(e){case"&":return"&amp;";case">":return"&gt;";case"<":return"&lt;"}return e}function u(e){var t=e==null?"":e.toString();if(new RegExp("[><&]","g").test(t)){return t.replace(new RegExp("[><&]","g"),l)}return t}e.htmlEncode=u;function c(t,n){if(!t||t.indexOf("{{")<0){return t}if(!$.templates||!$.views){throw new ss.Exception("Please make sure that jsrender.js is included in the page!")}n=n||{};var i=$.templates(t);$.views.converters({text:e.text},i);return i.render(n)}e.jsRender=c;function f(e){window.console&&window.console.log(e)}e.log=f;function d(){return $("<div/>").appendTo(document.body)}e.newBodyDiv=d;function g(e){return $("<i/>").append(e.eq(0).clone()).html()}e.outerHtml=g})(Q||(Q={}));var Q;(function(e){function t(t,n){var i;n=$.extend({htmlEncode:true,okButton:e.text("Dialogs.OkButton"),title:e.text("Dialogs.AlertTitle"),onClose:null,onOpen:null,autoOpen:false,dialogClass:"s-MessageDialog s-AlertDialog",modal:true,width:"40%",maxWidth:"450",minWidth:"180",resizable:false,open:function(){if(n.onOpen)n.onOpen.call(this)},close:function(){i.dialog("destroy");if(n.onClose)n.onClose()}},n);if(n.htmlEncode)t=e.htmlEncode(t);if(!n.buttons){var r=[];r.push({text:n.okButton,click:function(){i.dialog("close")}});n.buttons=r}i=$('<div><div class="message"></div></div>').dialog(n).children(".message").html(t).parent().dialog("open")}e.alert=t;function n(t,n,i){var r;i=$.extend({htmlEncode:true,yesButton:e.text("Dialogs.YesButton"),noButton:e.text("Dialogs.NoButton"),title:e.text("Dialogs.ConfirmationTitle"),onNo:null,onCancel:null,onClose:null,autoOpen:false,modal:true,dialogClass:"s-MessageDialog s-ConfirmDialog",width:"40%",maxWidth:"450",minWidth:"180",resizable:false,open:function(){if(i.onOpen)i.onOpen.call(this)},close:function(){r.dialog("destroy");if(!a&&i.onCancel)i.onCancel()},overlay:{opacity:.77,background:"black"}},i);if(i.htmlEncode)t=e.htmlEncode(t);var a=false;if(!i.buttons){var o=[];o.push({text:i.yesButton,click:function(){a=true;r.dialog("close");if(n)n()}});if(i.noButton)o.push({text:i.noButton,click:function(){a=true;r.dialog("close");if(i.onNo)i.onNo();else if(i.onCancel)i.onCancel()}});i.buttons=o}r=$('<div><div class="message"></div></div>').dialog(i).children(".message").html(t).parent().dialog("open")}e.confirm=n;function i(t){var n;var i=$("<div><iframe></iframe></div>");var r=$.extend({autoOpen:true,modal:true,width:"60%",height:"400",title:e.text("Dialogs.AlertTitle"),open:function(){n=i.find("iframe").css({border:"none",width:"100%",height:"100%"})[0].contentDocument;n.open();n.write(r.html);n.close()},close:function(){n.open();n.write("");n.close();i.dialog("destroy").html("")}},t);i.dialog(r)}e.iframeDialog=i;function r(t,i,r){n(t,i,$.extend({title:e.text("Dialogs.InformationTitle"),dialogClass:"s-MessageDialog s-InformationDialog",yesButton:e.text("Dialogs.OkButton"),noButton:null},r))}e.information=r;function a(n,i){t(n,$.extend({title:e.text("Dialogs.WarningTitle"),dialogClass:"s-MessageDialog s-WarningDialog"},i))}e.warning=a})(Q||(Q={}));var Q;(function(e){e.defaultNotifyOptions={timeOut:3e3,showDuration:250,hideDuration:500,extendedTimeOut:500,positionClass:"toast-top-full-width"};function t(t){t=$.extend({},e.defaultNotifyOptions,t);o(true);return t}function n(e,n,i){toastr.warning(e,n,t(i))}e.notifyWarning=n;function i(e,n,i){toastr.success(e,n,t(i))}e.notifySuccess=i;function r(e,n,i){toastr.info(e,n,t(i))}e.notifyInfo=r;function a(e,n,i){toastr.error(e,n,t(i))}e.notifyError=a;function o(e){if(typeof toastr==="undefined"){return}var t=$(window.document.body).children(".ui-dialog:visible").last();var n=toastr.getContainer(null,e);if(n.length===0){return}if(t.length>0){var i=t.position();n.addClass("positioned-toast toast-top-full-width");n.css({position:"absolute",top:i.top+28+"px",left:i.left+6+"px",width:t.width()-12+"px"})}else{n.addClass("toast-top-full-width");if(n.hasClass("positioned-toast")){n.removeClass("positioned-toast");n.css({position:"",top:"",left:"",width:""})}}}e.positionToastContainer=o})(Q||(Q={}));var Q;(function(e){var t;(function(t){function n(t){var n;if(t==null){n="??ERROR??"}else{n=t.Message;if(n==null){n=t.Code}}e.alert(n)}t.showServiceError=n})(t=e.ErrorHandling||(e.ErrorHandling={}))})(Q||(Q={}));var Q;(function(e){var t;(function(e){e.applicationPath="/";var t=$("link#ApplicationPath");if(t.length>0){e.applicationPath=t.attr("href")}e.emailAllowOnlyAscii=true;e.responsiveDialogs=false;e.rootNamespaces=["Serenity"];e.notLoggedInHandler=null})(t=e.Config||(e.Config={}))})(Q||(Q={}));var Q;(function(e){function t(e){var t;if(e===undefined)t=location.search.substring(1,location.search.length);else t=e||"";var n={};var i=t.split("&");for(var r=0;r<i.length;r++){var a=i[r].split("=");var o=decodeURIComponent(a[0]);n[o]=a.length>=2?decodeURIComponent(a[1]):o}return n}e.parseQueryString=t;function n(t){var n=$("<form/>").attr("method","POST").attr("action",t.url?r(t.url):r("~/services/"+t.service)).appendTo(document.body);if(t.target)n.attr("target",t.target);var i=$("<div/>").appendTo(n);$("<input/>").attr("type","hidden").attr("name","request").val($["toJSON"](t.request)).appendTo(i);var a=e.getCookie("CSRF-TOKEN");if(a){$("<input/>").attr("type","hidden").attr("name","__RequestVerificationToken").appendTo(i).val(a)}$("<input/>").attr("type","submit").appendTo(i);n.submit();window.setTimeout(function(){n.remove()},0)}e.postToService=n;function i(t){var n=$("<form/>").attr("method","POST").attr("action",r(t.url)).appendTo(document.body);if(t.target)n.attr("target",t.target);var i=$("<div/>").appendTo(n);if(t.params!=null){for(var a in t.params){$("<input/>").attr("type","hidden").attr("name",a).val(t.params[a]).appendTo(i)}}var o=e.getCookie("CSRF-TOKEN");if(o){$("<input/>").attr("type","hidden").attr("name","__RequestVerificationToken").appendTo(i).val(o)}$("<input/>").attr("type","submit").appendTo(i);n.submit();window.setTimeout(function(){n.remove()},0)}e.postToUrl=i;function r(t){if(t&&t.substr(0,2)==="~/"){return e.Config.applicationPath+t.substr(2)}return t}e.resolveUrl=r})(Q||(Q={}));var Q;(function(e){function t(e){if($.cookie)return $.cookie(e);e+="=";for(var t=document.cookie.split(/;\s*/),n=t.length-1;n>=0;n--)if(!t[n].indexOf(e))return t[n].replace(e,"")}e.getCookie=t;$.ajaxSetup({beforeSend:function(t){var n=e.getCookie("CSRF-TOKEN");if(n)t.setRequestHeader("X-CSRF-TOKEN",n)}});function n(t){var n=function(n){if(e.Config.notLoggedInHandler!=null&&n&&n.Error&&n.Error.Code=="NotLoggedIn"&&e.Config.notLoggedInHandler(t,n)){return}if(t.onError!=null){t.onError(n);return}e.ErrorHandling.showServiceError(n.Error)};var i=t.service;if(i&&i.length&&i.charAt(0)!="~"&&i.charAt(0)!="/"&&i.indexOf("://")<0)i=e.resolveUrl("~/services/")+i;t=$.extend({dataType:"json",contentType:"application/json",type:"POST",cache:false,blockUI:true,url:i,data:$.toJSON(t.request),success:function(n,i,r){try{if(!n.Error&&t.onSuccess){t.onSuccess(n)}}finally{if(t.blockUI){e.blockUndo()}t.onCleanup&&t.onCleanup()}},error:function(i,r,a){try{if(i.status===403){var o=null;try{o=i.getResponseHeader("Location")}catch(s){o=null}if(o){window.top.location.href=o;return}}if((i.getResponseHeader("content-type")||"").toLowerCase().indexOf("application/json")>=0){var l=$.parseJSON(i.responseText);if(l&&l.Error){n(l);return}}var u=i.responseText;if(!u){if(!i.status)e.alert("An unknown AJAX connection error occured! Check browser console for details.");else if(i.status==500)e.alert("HTTP 500: Connection refused! Check browser console for details.");else e.alert("HTTP "+i.status+" error! Check browser console for details.")}else e.iframeDialog({html:u})}finally{if(t.blockUI){e.blockUndo()}t.onCleanup&&t.onCleanup()}}},t);if(t.blockUI){e.blockUI(null)}return $.ajax(t)}e.serviceCall=n;function i(e,t,i,r){return n($.extend({service:e,request:t,onSuccess:i},r))}e.serviceRequest=i;function r(e,t,n){if(e.EqualityFilter==null){e.EqualityFilter={}}e.EqualityFilter[t]=n}e.setEquality=r})(Q||(Q={}));var Q;(function(e){function t(e){e.css("height","100%");o(e)}e.autoFullHeight=t;function n(t){$("body").addClass("full-height-page");t.addClass("responsive-height");var n=function(){var e=t.parent().hasClass("page-content")||t.parent().is("section.content");if(e){t.css("height","1px").css("overflow","hidden")}r(t);if(e){t.css("overflow","")}t.triggerHandler("layout")};if($("body").hasClass("has-layout-event")){$("body").bind("layout",n)}else if(window.Metronic){window.Metronic.addResizeHandler(n)}else{$(window).resize(n)}n();t.one("remove",function(){$(window).off("layout",n);$("body").off("layout",n)});e.Router.resolve()}e.initFullHeightGridPage=n;function i(e){var t=0;e.parent().children().not(e).each(function(e,n){var i=$(n);if(i.is(":visible")){t+=i.outerHeight(true)}});t=e.parent().height()-t;if(e.css("box-sizing")!=="border-box"){t=t-(e.outerHeight(true)-e.height())}return t}e.layoutFillHeightValue=i;function r(e){var t=i(e);var n=Math.round(t)+"px";if(e.css("height")!=n){e.css("height",n)}}e.layoutFillHeight=r;function a(){var e=navigator.userAgent.indexOf("Mobi")>=0||window.matchMedia("(max-width: 767px)").matches;var t=$(document.body);if(t.hasClass("mobile-device")){if(!e){t.removeClass("mobile-device")}}else if(e){t.addClass("mobile-device")}}e.setMobileDeviceMode=a;function o(e){Serenity.LazyLoadHelper.executeEverytimeWhenShown(e,function(){e.triggerHandler("layout")},true)}e.triggerLayoutOnShow=o;function s(e){if(!e.hasClass("ui-dialog"))e=e.closest(".ui-dialog");e.position({at:"center center",of:window});var t=e.position();if(t.left<0)e.css("left","0px");if(t.top<0)e.css("top","0px")}e.centerDialog=s})(Q||(Q={}));var Q;(function(e){var t;(function(t){var n={};var i={};function r(e,t,n){$(document.body).bind("scriptdatachange."+t,function(t,i){if(i==e){n()}})}t.bindToChange=r;function a(e){$(document.body).triggerHandler("scriptdatachange",[e])}t.triggerChange=a;function o(e){$(document.body).unbind("scriptdatachange."+e)}t.unbindFromChange=o;function s(e){$.ajax({async:false,cache:true,type:"GET",url:e,data:null,dataType:"script"})}function l(t){return Promise.resolve().then(function(){e.blockUI(null);return Promise.resolve($.ajax({async:true,cache:true,type:"GET",url:t,data:null,dataType:"script"}).always(function(){e.blockUndo()}))},null)}function u(t){if(n[t]==null){throw new Error(e.format("Script data {0} is not found in registered script list!",t))}t=t+".js?"+n[t];s(e.resolveUrl("~/DynJS.axd/")+t)}function c(t){return Promise.resolve().then(function(){if(n[t]==null){throw new Error(e.format("Script data {0} is not found in registered script list!",t))}t=t+".js?"+n[t];return l(e.resolveUrl("~/DynJS.axd/")+t)},null)}function f(t){var n=i[t];if(n==null){u(t)}n=i[t];if(n==null)throw new Error(e.format("Can't load script data: {0}!",t));return n}t.ensure=f;function d(t){return Promise.resolve().then(function(){var n=i[t];if(n!=null){return Promise.resolve(n)}return c(t).then(function(){n=i[t];if(n==null){throw new Error(e.format("Can't load script data: {0}!",t))}return n},null)},null)}t.ensureAsync=d;function g(t){if(n[t]==null){throw new Error(e.format("Script data {0} is not found in registered script list!",t))}n[t]=(new Date).getTime().toString();u(t);var r=i[t];return r}t.reload=g;function p(t){return Promise.resolve().then(function(){if(n[t]==null){throw new Error(e.format("Script data {0} is not found in registered script list!",t))}n[t]=(new Date).getTime().toString();return c(t).then(function(){return i[t]},null)},null)}t.reloadAsync=p;function h(e){return i[e]!=null||n[e]!=null}t.canLoad=h;function v(e){n={};var t=(new Date).getTime();for(var i in e){n[i]=e[i]||t}}t.setRegisteredScripts=v;function m(e,t){i[e]=t;a(e)}t.set=m})(t=e.ScriptData||(e.ScriptData={}));function n(e){return t.ensure("RemoteData."+e)}e.getRemoteData=n;function i(e){return t.ensureAsync("RemoteData."+e)}e.getRemoteDataAsync=i;function r(e){return t.ensure("Lookup."+e)}e.getLookup=r;function a(e){return t.ensureAsync("Lookup."+e)}e.getLookupAsync=a;function o(e){t.reload("Lookup."+e)}e.reloadLookup=o;function s(e){return t.reloadAsync("Lookup."+e)}e.reloadLookupAsync=s;function l(e){return t.ensure("Columns."+e)}e.getColumns=l;function u(e){return t.ensureAsync("Columns."+e)}e.getColumnsAsync=u;function c(e){return t.ensure("Form."+e)}e.getForm=c;function f(e){return t.ensureAsync("Form."+e)}e.getFormAsync=f;function d(e){return t.ensure("Template."+e)}e.getTemplate=d;function g(e){return t.ensureAsync("Template."+e)}e.getTemplateAsync=g;function p(e){return t.canLoad(e)}e.canLoadScriptData=p})(Q||(Q={}));var Q;(function(e){function t(e,t,n,i){n=n||"get_"+t;i=i||"set_"+t;Object.defineProperty(e.prototype,t,{get:function(){return this[n]()},set:function(e){return this[i](e)},configurable:true,enumerable:true})}e.prop=t;function n(e,t,n){function i(e,t,r){if(!e)return;if($.isArray(e)||e instanceof Date)return;var a=typeof e;if(a=="string"||a=="number")return;if($.isFunction(e)||e.__enum&&e.__register)n(e,t);if(r>3)return;for(var o=0,s=Object.keys(e);o<s.length;o++){var l=s[o];if(l.charAt(0)<"A"||l.charAt(0)>"Z")continue;if(l.indexOf("$")>=0)continue;if(l=="prototype")continue;i(e[l],t+"."+l,r+1)}}for(var r=0,a=t;r<a.length;r++){var o=a[r];if(o==null||!o.length){continue}if(o.indexOf(".")>=0){var s=e;var l=o.split(".");for(var u=0,c=l;u<c.length;u++){var f=c[u];if(!f.length)continue;s=s[f];if(!s)continue}i(s,o,0)}i(e[o],o,0)}}(function(t){ss.initAssembly({},"App",{});t.Q$Externals=e;t.Q$Config=e.Config;t.Q$Culture=e.Culture;t.Q$Lookup=e.Lookup;t.Q$ScriptData=e.ScriptData;t.Q$LT=e.LT;function i(){n(t,e.Config.rootNamespaces,function(e,t){if(e.hasOwnProperty("__typeName")&&!e.__register)return;if(!e.__interfaces&&e.prototype.format&&t.substr(-9)=="Formatter"){e.__class=true;e.__interfaces=[Serenity.ISlickFormatter]}if(!e.__class){var n=ss.getBaseType(e);if(n&&n.__class)e.__class=true}if(e.__class||e.__enum||e.__interface){e.__typeName=t;if(!e.__assembly){e.__assembly=ss.__assemblies["App"]}e.__assembly.__types[t]=e}delete e.__register})}$(function(){i();e.setMobileDeviceMode();$(t).bind("resize",function(){e.setMobileDeviceMode()})})})(window||{})})(Q||(Q={}));var Q;(function(e){var t;(function(t){function n(e){if(e==null)return false;if(e=="*")return true;if(e==""||e=="?")return t.isLoggedIn;var n=t.userDefinition;if(n&&n.IsAdmin)return true;if(n&&n.Permissions){var i=n.Permissions;if(i[e])return true;var r=e.split("|");for(var a=0,o=r;a<o.length;a++){var s=o[a];if(!s)continue;var l=s.split("&");if(!l.length)continue;var u=false;for(var c=0,f=l;c<f.length;c++){var d=f[c];if(!i[d]){u=true;break}}if(!u)return true}}return false}t.hasPermission=n;function i(t){if(!n(t)){e.notifyError(e.text("Authorization.AccessDenied"));throw new Error(e.text("Authorization.AccessDenied"))}}t.validatePermission=i})(t=e.Authorization||(e.Authorization={}));Object.defineProperty(e.Authorization,"userDefinition",{get:function(){return e.getRemoteData("UserData")}});Object.defineProperty(e.Authorization,"isLoggedIn",{get:function(){var e=t.userDefinition;return e&&!!e.Username}});Object.defineProperty(e.Authorization,"username",{get:function(){var e=t.userDefinition;if(e)return e.Username;return null}})})(Q||(Q={}));var Q;(function(e){var t;(function(t){var n;var i=0;var r=0;var a;var o=0;var s=0;t.enabled=true;function l(e,t){return e==t||e==t+"#"||t==e+"#"}function u(e,r,a){if(!t.enabled||i>0)return;e=e||"";e=e.replace(/^#/,"");e=!e?"":"#"+e;var o=window.location.href.replace(/#$/,"").replace(/#.*$/,"")+e;if(o!=window.location.href){if(r&&n!=null&&l(n,o)){if(a)m();var s=window.location.href;n=null;window.history.back();return}if(a)m();n=window.location.href;window.location.hash=e}}t.navigate=u;function c(e,t){u(e,t,true)}t.replace=c;function f(e,n){if(!t.enabled)return;var i=window.location.hash||"";if(i.charAt(0)=="#")i=i.substr(1,i.length-1);var r=i.split("/+/");if(r.length>1){if(e&&e.length){r[r.length-1]=e;e=r.join("/+/")}else{r.splice(r.length-1,1);e=r.join("/+/")}}c(e,n)}t.replaceLast=f;function d(){return $(".ui-dialog-content:visible, .ui-dialog.panel-hidden>.ui-dialog-content, .s-Panel").toArray().sort(function(e,t){return($(e).data("qrouterorder")||0)-($(t).data("qrouterorder")||0)})}function g(t,n,i){var r=[];var a=t.hasClass(".ui-dialog-content")||t.hasClass(".s-Panel");var o=a?t:t.closest(".ui-dialog-content, .s-Panel");var s=i();var l;if(o.length){var u=d();var g=u.indexOf(o[0]);for(var p=0;p<=g;p++){var h=$(u[p]).data("qroute");if(h&&h.length)r.push(h)}if(!a){l=o.attr("id");if(l){l+="_";var v=t.attr("id");if(v&&e.startsWith(v,l))s=v.substr(l.length)+"@"+s}}}else{var v=t.attr("id");if(v&&(!t.hasClass("route-handler")||$(".route-handler").first().attr("id")!=v))s=v+"@"+s}r.push(s);n.data("qroute",s);c(r.join("/+/"));n.bind("dialogclose.qrouter panelclose.qrouter",function(e){n.data("qroute",null);n.unbind(".qrouter");var t=n.data("qprhash");var i=$(e.target).closest(".s-MessageDialog").length>0||e&&e.originalEvent&&(e.originalEvent.type=="keydown"&&e.originalEvent.keyCode==27||$(e.originalEvent.target).hasClass("ui-dialog-titlebar-close")||$(e.originalEvent.target).hasClass("panel-titlebar-close"));
if(t!=null)c(t,i);else f("",i)})}function p(e,n,i){if(!t.enabled)return;n.on("dialogopen.qrouter panelopen.qrouter",function(t){g(e,n,i)})}t.dialog=p;function h(n){if(!t.enabled)return;i++;try{n=e.coalesce(e.coalesce(n,window.location.hash),"");if(n.charAt(0)=="#")n=n.substr(1,n.length-1);var r=d();var a=n.split("/+/");var o=r.map(function(e){return $(e).data("qroute")});var s=0;while(s<r.length&&s<a.length&&o[s]==a[s]){s++}for(var l=s;l<r.length;l++){var u=$(r[l]);if(u.hasClass("ui-dialog-content"))u.dialog("close");else if(u.hasClass("s-Panel"))Serenity.TemplatedDialog.closePanel(u)}for(var l=s;l<a.length;l++){var c=a[l];var f=c.split("@");var g;if(f.length==2){var p=l>0?$(r[l-1]):$([]);if(p.length){var h=p.attr("id");if(h){g=$("#"+h+"_"+f[0]);if(g.length){c=f[1]}}}if(!g||!g.length){g=$("#"+f[0]);if(g.length){c=f[1]}}}if(!g||!g.length){g=l>0?$(r[l-1]):$(".route-handler").first()}g.triggerHandler("handleroute",{handled:false,route:c,parts:a,index:l})}}finally{i--}}t.resolve=h;function v(e,t){if(o>0){if((new Date).getTime()-s>1e3){o=0}else{o--;return}}h()}function m(){o++;s=(new Date).getTime()}window.addEventListener("hashchange",v,false);var y=1;$(document).on("dialogopen panelopen",".ui-dialog-content, .s-Panel",function(e,n){if(!t.enabled)return;var i=$(e.target);i.data("qrouterorder",y++);if(i.data("qroute"))return;i.data("qprhash",window.location.hash);var a=$(d).not(i).last();if(!a.length)a=$("html");g(a,i,function(){return"!"+(++r).toString(36)})})})(t=e.Router||(e.Router={}))})(Q||(Q={}));var Serenity;(function(e){var t=function(){function e(e){this.value=e}return e}();e.ColumnsKeyAttribute=t;var n=function(){function e(e){this.value=e}return e}();e.DialogTypeAttribute=n;var i=function(){function e(){}return e}();e.EditorAttribute=i;var r=function(){function e(e){this.value=e}return e}();e.ElementAttribute=r;var a=function(){function e(e){this.value=e}return e}();e.EntityTypeAttribute=a;var o=function(){function e(e){this.value=e}return e}();e.EnumKeyAttribute=o;var s=function(){function e(e){if(e===void 0){e=true}this.value=e}return e}();e.FlexifyAttribute=s;var l=function(){function e(e){this.value=e}return e}();e.FormKeyAttribute=l;var u=function(){function e(e){this.origin=e}return e}();e.GeneratedCodeAttribute=u;var c=function(){function e(e){this.value=e}return e}();e.IdPropertyAttribute=c;var f=function(){function e(e){this.value=e}return e}();e.IsActivePropertyAttribute=f;var d=function(){function e(e){this.value=e}return e}();e.ItemNameAttribute=d;var g=function(){function e(e){this.value=e}return e}();e.LocalTextPrefixAttribute=g;var p=function(){function e(e){if(e===void 0){e=true}this.value=e}return e}();e.MaximizableAttribute=p;var h=function(){function e(e){this.value=e}return e}();e.NamePropertyAttribute=h;var v=function(){function e(){}return e}();e.OptionAttribute=v;var m=function(){function e(e){this.value=e}return e}();e.OptionsTypeAttribute=m;var y=function(){function e(e){if(e===void 0){e=true}this.value=e}return e}();e.PanelAttribute=y;var b=function(){function e(e){if(e===void 0){e=true}this.value=e}return e}();e.ResizableAttribute=b;var w=function(){function e(e){if(e===void 0){e=true}this.value=e}return e}();e.ResponsiveAttribute=w;var C=function(){function e(e){this.value=e}return e}();e.ServiceAttribute=C})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(t){function n(e,t){e.__metadata=e.__metadata||{};e.__metadata.attr=e.__metadata.attr||[];e.__metadata.attr.push(t)}t.addAttribute=n;function i(e,t,n){e.__metadata=e.__metadata||{};e.__metadata.members=e.__metadata.members||[];var i=undefined;for(var r=0,a=e.__metadata.members;r<a.length;r++){var o=a[r];if(o.name==t){i=o;break}}if(!i){i={name:t,attr:[],type:4,returnType:Object,sname:t};e.__metadata.members.push(i)}i.attr=i.attr||[];i.attr.push(n)}t.addMemberAttr=i;function r(t){return function(i){n(i,new e.ColumnsKeyAttribute(t))}}t.columnsKey=r;function a(t){return function(i){n(i,new e.DialogTypeAttribute(t))}}t.dialogType=a;function o(t){return function(i){var r=new e.EditorAttribute;if(t!==undefined)r.key=t;n(i,r)}}t.editor=o;function s(t){return function(i){n(i,new e.ElementAttribute(t))}}t.element=s;function l(t){return function(i){n(i,new e.EntityTypeAttribute(t))}}t.entityType=l;function u(t){return function(i){n(i,new e.EnumKeyAttribute(t))}}t.enumKey=u;function c(t){if(t===void 0){t=true}return function(i){n(i,new e.FlexifyAttribute(t))}}t.flexify=c;function f(t){return function(i){n(i,new e.FormKeyAttribute(t))}}t.formKey=f;function d(t){return function(i){n(i,new e.GeneratedCodeAttribute(t))}}t.generatedCode=d;function g(t){return function(i){n(i,new e.IdPropertyAttribute(t))}}t.idProperty=g;function p(e,t){return function(n){n.__register=true;n.__class=true;n.__assembly=t||ss.__assemblies["App"];if(e)n.__interfaces=e}}t.registerClass=p;function h(e,t){return function(n){n.__register=true;n.__interface=true;n.__assembly=t||ss.__assemblies["App"];if(e)n.__interfaces=e;n.isAssignableFrom=function(e){return ss.contains(ss.getInterfaces(e),this)}}}t.registerInterface=h;function v(t,i,r){if(!t.__enum){Object.defineProperty(t,"__enum",{get:function(){return true}});t.prototype=t.prototype||{};for(var a=0,o=Object.keys(t);a<o.length;a++){var s=o[a];if(isNaN(Q.parseInteger(s))&&t[s]!=null&&!isNaN(Q.parseInteger(t[s])))t.prototype[s]=t[s]}t.__register=true;if(i)n(t,new e.EnumKeyAttribute(i))}}t.registerEnum=v;function m(e,t){return p(e,t)}t.registerEditor=m;function y(t,n){if(t===void 0){t=[e.ISlickFormatter]}return p(t,n)}t.registerFormatter=y;function b(t){if(t===void 0){t=true}return function(i){n(i,new e.FilterableAttribute(t))}}t.filterable=b;function w(t){return function(i){n(i,new e.ItemNameAttribute(t))}}t.itemName=w;function C(t){return function(i){n(i,new e.IsActivePropertyAttribute(t))}}t.isActiveProperty=C;function _(t){return function(i){n(i,new e.LocalTextPrefixAttribute(t))}}t.localTextPrefix=_;function $(t){if(t===void 0){t=true}return function(i){n(i,new e.MaximizableAttribute(t))}}t.maximizable=$;function x(t){return function(i){n(i,new e.NamePropertyAttribute(t))}}t.nameProperty=x;function S(){return function(t,n){i(t.constructor,n,new e.OptionAttribute)}}t.option=S;function T(t){return function(i){n(i,new e.OptionsTypeAttribute(t))}}t.optionsType=T;function A(t){if(t===void 0){t=true}return function(i){n(i,new e.PanelAttribute(t))}}t.panel=A;function P(t){if(t===void 0){t=true}return function(i){n(i,new e.ResizableAttribute(t))}}t.resizable=P;function k(t){if(t===void 0){t=true}return function(i){n(i,new e.ResponsiveAttribute(t))}}t.responsive=k;function D(t){return function(i){n(i,new e.ServiceAttribute(t))}}t.service=D})(t=e.Decorators||(e.Decorators={}))})(Serenity||(Serenity={}));var Serenity;(function(e){function t(e){return[e]}e.Criteria=t;(function(e){var t=e;function n(e){return e==null||e.length===0||e.length===1&&typeof e[0]=="string"&&e[0].length===0}e.isEmpty=n;function i(e,n,i){if(t.isEmpty(e))return i;if(t.isEmpty(i))return e;return[e,n,i]}e.join=i;function r(e){return t.isEmpty(e)?e:["()",e]}e.paren=r;function a(e,t){var n=[];for(var r=2;r<arguments.length;r++){n[r-2]=arguments[r]}var a=i(e,"and",t);if(n){for(var o=0,s=n;o<s.length;o++){var l=s[o];a=i(a,"and",l)}}return a}e.and=a;function o(e,t){var n=[];for(var r=2;r<arguments.length;r++){n[r-2]=arguments[r]}var a=i(e,"or",t);if(n){for(var o=0,s=n;o<s.length;o++){var l=s[o];a=i(a,"or",l)}}return a}e.or=o})(t=e.Criteria||(e.Criteria={}))})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(e){var t=0;function n(e,n){t++;var i="ExecuteOnceWhenShown"+t;var r=false;if(e.is(":visible")){n()}else{var a=e.closest(".ui-tabs");if(a.length>0){a.bind("tabsshow."+i,function(t){if(e.is(":visible")){a.unbind("tabsshow."+i);if(!r){r=true;e.unbind("shown."+i);n()}}})}var o=e.closest(".nav-tabs");if(o.length>0){o.one("shown.bs.tab",function(t){if(!r&&e.is(":visible")){r=true;n()}})}var s;if(e.hasClass("ui-dialog")){s=e.children(".ui-dialog-content")}else{s=e.closest(".ui-dialog-content, .s-TemplatedDialog")}if(s.length>0){s.bind("dialogopen."+i+" panelopen."+i,function(){s.unbind("dialogopen."+i);s.unbind("panelopen."+i);if(e.is(":visible")&&!r){r=true;e.unbind("shown."+i);n()}})}e.bind("shown."+i,function(){if(e.is(":visible")){e.unbind("shown."+i);if(!r){r=true;n()}}})}}e.executeOnceWhenShown=n;function i(e,n,i){t++;var r="ExecuteEverytimeWhenShown"+t;var a=e.is(":visible");if(a&&i){n()}var o=function(t){if(e.is(":visible")){if(!a){a=true;n()}}else{a=false}};var s=e.closest(".ui-tabs");if(s.length>0){s.bind("tabsactivate."+r,o)}var l=e.closest(".ui-dialog-content, .s-TemplatedDialog");if(l.length>0){l.bind("dialogopen."+r+" panelopen."+r,o)}e.bind("shown."+r,o)}e.executeEverytimeWhenShown=i})(t=e.LazyLoadHelper||(e.LazyLoadHelper={}))})(Serenity||(Serenity={}));var Serenity;(function(e){var t;(function(e){function t(e,t,n){if(!e)return;var r=i(e);if(!r)return;var a=r[t];if(a==null){return}if(a===e.tabs("option","active")){e.tabs("option","active",0)}e.tabs(n?"disable":"enable",a)}e.setDisabled=t;function n(e){var t=e.children("ul").children("li").eq(e.tabs("option","active")).children("a").attr("href").toString();var n="_Tab";var i=t.lastIndexOf(n);if(i>=0){t=t.substr(i+n.length)}return t}e.activeTabKey=n;function i(e){var t=e.data("indexByKey");if(!t){t={};e.children("ul").children("li").children("a").each(function(e,n){var i=n.getAttribute("href").toString();var r="_Tab";var a=i.lastIndexOf(r);if(a>=0){i=i.substr(a+r.length)}t[i]=e});e.data("indexByKey",t)}return t}e.indexByKey=i;function r(e,t){var n=i(e);if(!n)return;var r=n[t];if(r==null){return}if(r!==e.tabs("option","active")){e.tabs("option","active",r)}}e.selectTab=r})(t=e.TabsExtensions||(e.TabsExtensions={}))})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(e,t){var i=this;this.element=e;this.options=t||{};this.widgetName=n.getWidgetName(ss.getInstanceType(this));this.uniqueName=this.widgetName+(n.nextWidgetNumber++).toString();if(e.data(this.widgetName)){throw new ss.Exception(Q.format("The element already has widget '{0}'!",this.widgetName))}e.bind("remove."+this.widgetName,function(e){if(e.bubbles||e.cancelable){return}i.destroy()}).data(this.widgetName,this);this.addCssClass();if(this.isAsyncWidget()){window.setTimeout(function(){if(e&&!i.asyncPromise){i.asyncPromise=i.initializeAsync()}},0)}}n=t;t.prototype.destroy=function(){this.element.removeClass("s-"+ss.getTypeName(ss.getInstanceType(this)));this.element.unbind("."+this.widgetName).unbind("."+this.uniqueName).removeData(this.widgetName);this.element=null;this.asyncPromise=null};t.prototype.addCssClass=function(){this.element.addClass(this.getCssClass())};t.prototype.getCssClass=function(){var e=ss.getInstanceType(this);var t="s-"+ss.getTypeName(e);var n=Q.replaceAll(ss.getTypeFullName(e),".","-");for(var i=0,r=Q.Config.rootNamespaces;i<r.length;i++){var a=r[i];if(Q.startsWith(n,a+"-")){n=n.substr(a.length+1);break}}n="s-"+n;if(t===n){return t}return t+" "+n};t.prototype.initializeAsync=function(){return Promise.resolve()};t.prototype.isAsyncWidget=function(){return ss.isInstanceOfType(this,e.IAsyncInit)};t.getWidgetName=function(e){return Q.replaceAll(ss.getTypeFullName(e),".","_")};t.elementFor=function(t){var n=ss.getAttributes(t,e.ElementAttribute,true);var i=n.length>0?n[0].value:"<input/>";return $(i)};t.create=function(t){var i;if(ss.isAssignableFrom(e.IDialog,t.type)){i=new t.type(t.options);if(t.container)i.element.appendTo(t.container);t.element&&t.element(i.element)}else{var r=n.elementFor(t.type);if(t.container)r.appendTo(t.container);t.element&&t.element(r);i=new t.type(r,t.options)}i.init(t.init);return i};t.prototype.init=function(e){var t=this;var n=this.initialize();if(e){n.then(function(){return e(t)})}return this};t.prototype.initialize=function(){if(!this.isAsyncWidget()){return Promise.resolve()}if(!this.asyncPromise){this.asyncPromise=this.initializeAsync()}return this.asyncPromise};t.nextWidgetNumber=0;t=n=__decorate([e.Decorators.registerClass()],t);return t;var n}();e.Widget=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(e,n){var i=t.call(this,e,n)||this;i.idPrefix=i.uniqueName+"_";var r=i.getTemplate().replace(new RegExp("~_","g"),i.idPrefix);var a=0;while(true){var o=r.indexOf('{{text:"',a);if(o<0)break;var a=r.indexOf('"}}',o);if(a<0)break;var s=r.substr(o+8,a-o-8);var l=Q.text(s);r=r.substr(0,o)+l+r.substr(a+3);a=o+l.length}i.element.html(r);return i}i=n;n.prototype.byId=function(e){return $("#"+this.idPrefix+e)};n.prototype.byID=function(t,n){return e.WX.getWidget(this.byId(t),n)};n.noGeneric=function(e){var t=e.indexOf("$");if(t>=0){return e.substr(0,t)}return e};n.prototype.getDefaultTemplateName=function(){return i.noGeneric(ss.getTypeName(ss.getInstanceType(this)))};n.prototype.getTemplateName=function(){var t=ss.getInstanceType(this);var n=ss.getTypeFullName(t);var r=i.templateNames;var a=i.templateNames[n];if(a!=null){return a}while(t&&t!==e.Widget){var o=i.noGeneric(ss.getTypeFullName(t));for(var s=0,l=Q.Config.rootNamespaces;s<l.length;s++){var u=l[s];if(Q.startsWith(o,u+".")){o=o.substr(u.length+1);break}}if(Q.canLoadScriptData("Template."+o)){r[n]=o;return o}o=Q.replaceAll(o,".","_");if(Q.canLoadScriptData("Template."+o)||$("script#Template_"+o).length>0){r[n]=o;return o}o=i.noGeneric(ss.getTypeName(t));if(Q.canLoadScriptData("Template."+o)||$("script#Template_"+o).length>0){i.templateNames[n]=o;return o}t=ss.getBaseType(t)}r[n]=a=this.getDefaultTemplateName();return a};n.prototype.getFallbackTemplate=function(){return null};n.prototype.getTemplate=function(){var e=this.getTemplateName();var t=$("script#Template_"+e);if(t.length>0){return t.html()}var n;if(!Q.canLoadScriptData("Template."+e)&&this.getDefaultTemplateName()==e){n=this.getFallbackTemplate();if(n!=null)return n}n=Q.getTemplate(e);if(n==null){throw new Error(Q.format("Can't locate template for widget '{0}' with name '{1}'!",ss.getTypeName(ss.getInstanceType(this)),e))}return n};n.templateNames={};n=i=__decorate([e.Decorators.registerClass()],n);return n;var i}(e.Widget);e.TemplatedWidget=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface()],t);return t}();e.IBooleanValue=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface()],t);return t}();e.IDoubleValue=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface()],t);return t}();e.IGetEditValue=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface()],t);return t}();e.ISetEditValue=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(){}t=__decorate([e.Decorators.registerInterface()],t);return t}();e.IStringValue=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(e){var n=t.call(this,e)||this;e.removeClass("flexify");return n}Object.defineProperty(n.prototype,"value",{get:function(){return this.element.is(":checked")},set:function(e){this.element.prop("checked",!!e)},enumerable:true,configurable:true});n.prototype.get_value=function(){return this.value};n.prototype.set_value=function(e){this.value=e};n=__decorate([e.Decorators.element('<input type="checkbox"/>'),e.Decorators.registerEditor([e.IBooleanValue])],n);return n}(e.Widget);e.BooleanEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(e,n){var i=t.call(this,e,n)||this;e.mask(i.options.mask||"",{placeholder:Q.coalesce(i.options.placeholder,"_")});return i}Object.defineProperty(n.prototype,"value",{get:function(){this.element.triggerHandler("blur.mask");return this.element.val()},set:function(e){this.element.val(e)},enumerable:true,configurable:true});n.prototype.get_value=function(){return this.value};n.prototype.set_value=function(e){this.value=e};n=__decorate([e.Decorators.element('<input type="text"/>'),e.Decorators.registerEditor([e.IStringValue])],n);return n}(e.Widget);e.MaskedEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(e){return t.call(this,e)||this}Object.defineProperty(n.prototype,"value",{get:function(){return this.element.val()},set:function(e){this.element.val(e)},enumerable:true,configurable:true});n.prototype.get_value=function(){return this.value};n.prototype.set_value=function(e){this.value=e};n=__decorate([e.Decorators.element('<input type="text"/>'),e.Decorators.registerEditor([e.IStringValue])],n);return n}(e.Widget);e.StringEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(e,n){var i=t.call(this,e,n)||this;if(i.options.cols!==0){e.attr("cols",Q.coalesce(i.options.cols,80))}if(i.options.rows!==0){e.attr("rows",Q.coalesce(i.options.rows,6))}return i}Object.defineProperty(n.prototype,"value",{get:function(){return this.element.val()},set:function(e){this.element.val(e)},enumerable:true,configurable:true});n.prototype.get_value=function(){return this.value};n.prototype.set_value=function(e){this.value=e};n=__decorate([e.Decorators.element("<textarea />"),e.Decorators.registerEditor([e.IStringValue])],n);return n}(e.Widget);e.TextAreaEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(e,n){var i=t.call(this,e,n)||this;e.addClass("editor s-TimeEditor hour");if(!i.options.noEmptyOption){Q.addOption(e,"","--")}for(var r=i.options.startHour||0;r<=(i.options.endHour||23);r++){Q.addOption(e,r.toString(),r<10?"0"+r:r.toString())}i.minutes=$("<select/>").addClass("editor s-TimeEditor minute").insertAfter(e);for(var a=0;a<=59;a+=i.options.intervalMinutes||5){Q.addOption(i.minutes,a.toString(),a<10?"0"+a:a.toString())}return i}Object.defineProperty(n.prototype,"value",{get:function(){var e=Q.toId(this.element.val());var t=Q.toId(this.minutes.val());if(e==null||t==null){return null}return e*60+t},set:function(e){if(!e){if(this.options.noEmptyOption){this.element.val(this.options.startHour);this.minutes.val("0")}else{this.element.val("");this.minutes.val("0")}}else{this.element.val(Math.floor(e/60).toString());this.minutes.val(e%60)}},enumerable:true,configurable:true});n.prototype.get_value=function(){return this.value};n.prototype.set_value=function(e){this.value=e};n=__decorate([e.Decorators.element("<select />"),e.Decorators.registerEditor([e.IDoubleValue])],n);return n}(e.Widget);e.TimeEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(e){var n=t.call(this,e)||this;e.addClass("url").attr("title","URL should be entered in format: 'http://www.site.com/page'.");e.on("blur."+n.uniqueName,function(t){var n=e.closest("form").data("validator");if(n==null)return;if(!e.hasClass("error"))return;var i=Q.trimToNull(e.val());if(!i)return;i="http://"+i;if($.validator.methods["url"].call(n,i,e[0])==true){e.val(i);n.element(e)}});return n}n=__decorate([e.Decorators.registerEditor([e.IStringValue])],n);return n}(e.StringEditor);e.URLEditor=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(e){var n=t.call(this,Q.newBodyDiv().addClass("s-TemplatedDialog hidden"),e)||this;n.element.attr("id",n.uniqueName);n.initValidator();n.initTabs();n.initToolbar();return n}i=n;Object.defineProperty(n.prototype,"isMarkedAsPanel",{get:function(){var t=ss.getAttributes(ss.getInstanceType(this),e.PanelAttribute,true);return t.length>0&&t[t.length-1].value!==false},enumerable:true,configurable:true});Object.defineProperty(n.prototype,"isResponsive",{get:function(){return Q.Config.responsiveDialogs||ss.getAttributes(ss.getInstanceType(this),e.ResponsiveAttribute,true).length>0},enumerable:true,configurable:true});n.getCssSize=function(e,t){var n=e.css(t);if(n==null){return null}if(!Q.endsWith(n,"px")){return null}n=n.substr(0,n.length-2);var i=Q.parseInteger(n);if(i==null||isNaN(i)||i==0)return null;return i};n.applyCssSizes=function(e,t){var n;var r=$("<div/>").hide().addClass(t).appendTo(document.body);try{var a=$("<div/>").addClass("size").appendTo(r);n=i.getCssSize(a,"minWidth");if(n!=null)e.minWidth=n;n=i.getCssSize(a,"width");if(n!=null)e.width=n;n=i.getCssSize(a,"height");if(n!=null)e.height=n;n=i.getCssSize(a,"minHeight");if(n!=null)e.minHeight=n}finally{r.remove()}};n.prototype.destroy=function(){this.tabs&&this.tabs.tabs("destroy");this.tabs=null;this.toolbar&&this.toolbar.destroy();this.toolbar=null;this.validator&&this.byId("Form").remove();this.validator=null;if(this.element!=null&&this.element.hasClass("ui-dialog-content")){this.element.dialog("destroy");this.element.removeClass("ui-dialog-content")}$(window).unbind("."+this.uniqueName);t.prototype.destroy.call(this)};n.prototype.initDialog=function(){var t=this;if(this.element.hasClass("ui-dialog-content"))return;this.element.removeClass("hidden");this.element.dialog(this.getDialogOptions());this.element.closest(".ui-dialog").on("resize",function(e){return t.arrange()});var n=ss.getInstanceType(this);if(this.isResponsive){e.DialogExtensions.dialogResizable(this.element);$(window).bind("resize."+this.uniqueName,function(e){if(t.element&&t.element.is(":visible")){t.handleResponsive()}});this.element.closest(".ui-dialog").addClass("flex-layout")}else if(ss.getAttributes(n,e.FlexifyAttribute,true).length>0){e.DialogExtensions.dialogFlexify(this.element);e.DialogExtensions.dialogResizable(this.element)}if(ss.getAttributes(n,e.MaximizableAttribute,true).length>0){e.DialogExtensions.dialogMaximizable(this.element)}var i=this;this.element.bind("dialogopen."+this.uniqueName,function(){$(document.body).addClass("modal-dialog-open");if(t.isResponsive){t.handleResponsive()}i.onDialogOpen()});this.element.bind("dialogclose."+this.uniqueName,function(){$(document.body).toggleClass("modal-dialog-open",$(".ui-dialog:visible").length>0);i.onDialogClose()})};n.prototype.initToolbar=function(){var t=this.byId("Toolbar");if(t.length===0){return}var n=this.element.closest(".ui-dialog");if(n.length===0){n=this.element}var i={buttons:this.getToolbarButtons(),hotkeyContext:n[0]};this.toolbar=new e.Toolbar(t,i)};n.prototype.getToolbarButtons=function(){return[]};n.prototype.getValidatorOptions=function(){return{}};n.prototype.initValidator=function(){var e=this.byId("Form");if(e.length>0){var t=this.getValidatorOptions();this.validator=e.validate(Q.validateOptions(t))}};n.prototype.resetValidation=function(){this.validator&&this.validator.resetAll()};n.prototype.validateForm=function(){return this.validator==null||!!this.validator.form()};n.prototype.dialogOpen=function(e){var t=this;e=Q.coalesce(e,this.isMarkedAsPanel);if(e){if(!this.element.hasClass("s-Panel")){this.element.on("panelopen."+this.uniqueName,function(){t.onDialogOpen()});this.element.on("panelclose."+this.uniqueName,function(){t.onDialogClose()})}i.openPanel(this.element,this.uniqueName);this.setupPanelTitle()}else{if(!this.element.hasClass("ui-dialog-content"))this.initDialog();this.element.dialog("open")}};n.openPanel=function(e,t){var n=$(".panels-container");if(!n.length)n=$("section.content");e.data("paneluniquename",t);if(n.length){n=n.last();n.children().not(e).not(".panel-hidden").addClass("panel-hidden panel-hidden-"+t);if(e[0].parentElement!==n[0])e.appendTo(n)}$(".ui-dialog:visible, .ui-widget-overlay:visible").not(e).addClass("panel-hidden panel-hidden-"+t);e.removeClass("hidden").removeClass("panel-hidden").addClass("s-Panel").trigger("panelopen")};n.closePanel=function(e,t){if(!e.hasClass("s-Panel")||e.hasClass("hidden"))return;var n=$.Event(t);n.type="panelbeforeclose";n.target=e[0];e.trigger(n);if(n.isDefaultPrevented())return;e.addClass("hidden");var i=e.data("paneluniquename")||(new Date).getTime();var r="panel-hidden-"+i;$("."+r).removeClass(r).removeClass("panel-hidden");$(window).triggerHandler("resize");$(".require-layout:visible").triggerHandler("layout");var t=$.Event(t);t.type="panelclose";t.target=e[0];e.trigger(t)};n.prototype.onDialogOpen=function(){if(!$(document.body).hasClass("mobile-device"))$(":input:eq(0)",this.element).focus();this.arrange();this.tabs&&this.tabs.tabs("option","active",0)};n.prototype.arrange=function(){this.element.find(".require-layout").filter(":visible").each(function(e,t){$(t).triggerHandler("layout")})};n.prototype.onDialogClose=function(){var e=this;$(document).trigger("click");if($.qtip){$(document.body).children(".qtip").each(function(e,t){$(t).qtip("hide")})}window.setTimeout(function(){var t=e.element;e.destroy();t.remove();Q.positionToastContainer(false)},0)};n.prototype.addCssClass=function(){if(this.isMarkedAsPanel){t.prototype.addCssClass.call(this);if(this.isResponsive)this.element.addClass("flex-layout")}};n.prototype.getDialogOptions=function(){var t={};var n="s-Dialog "+this.getCssClass();t.dialogClass=n;t.width=920;i.applyCssSizes(t,n);t.autoOpen=false;var r=ss.getInstanceType(this);t.resizable=ss.getAttributes(r,e.ResizableAttribute,true).length>0;t.modal=true;t.position={my:"center",at:"center",of:$(window.window)};t.title=Q.coalesce(this.element.data("dialogtitle"),this.getDialogTitle())||"";return t};n.prototype.getDialogTitle=function(){return""};n.prototype.dialogClose=function(){if(this.element.hasClass("ui-dialog-content"))this.element.dialog().dialog("close");else if(this.element.hasClass("s-Panel")&&!this.element.hasClass("hidden")){i.closePanel(this.element)}};Object.defineProperty(n.prototype,"dialogTitle",{get:function(){if(this.element.hasClass("ui-dialog-content"))return this.element.dialog("option","title");return this.element.data("dialogtitle")},set:function(e){var t=this.dialogTitle;this.element.data("dialogtitle",e);if(this.element.hasClass("ui-dialog-content"))this.element.dialog("option","title",e);else if(this.element.hasClass("s-Panel")){if(t!=this.dialogTitle){this.setupPanelTitle();this.arrange()}}},enumerable:true,configurable:true});n.prototype.setupPanelTitle=function(){var e=this;var t=Q.coalesce(this.dialogTitle,this.getDialogTitle());var n=this.element.children(".panel-titlebar");if(Q.isEmptyOrNull(t)){n.remove()}else{if(!this.element.children(".panel-titlebar").length){n=$("<div class='panel-titlebar'><div class='panel-titlebar-text'></div></div>").prependTo(this.element)}n.children(".panel-titlebar-text").text(t);if(this.element.hasClass("s-Panel")){if(!n.children(".panel-titlebar-close").length){$('<button class="panel-titlebar-close">&nbsp;</button>').prependTo(n).click(function(t){i.closePanel(e.element,t)})}}}};n.prototype.set_dialogTitle=function(e){this.dialogTitle=e};n.prototype.initTabs=function(){var e=this;var t=this.byId("Tabs");if(t.length===0){return}this.tabs=t.tabs({});this.tabs.bind("tabsactivate",function(){return e.arrange()})};n.prototype.handleResponsive=function(){var e=this.element.dialog();var t=this.element.closest(".ui-dialog");if($(document.body).hasClass("mobile-device")){var n=this.element.data("responsiveData");if(!n){n={};n.draggable=e.dialog("option","draggable");n.resizable=e.dialog("option","resizable");n.position=e.css("position");var i=t.position();n.left=i.left;n.top=i.top;n.width=t.width();n.height=t.height();n.contentHeight=this.element.height();this.element.data("responsiveData",n);e.dialog("option","draggable",false);e.dialog("option","resizable",false)}t.addClass("mobile-layout");t.css({left:"0px",top:"0px",width:$(window).width()+"px",height:$(window).height()+"px",position:"fixed"});$(document.body).scrollTop(0);Q.layoutFillHeight(this.element)}else{var r=this.element.data("responsiveData");if(r){e.dialog("option","draggable",r.draggable);e.dialog("option","resizable",r.resizable);this.element.closest(".ui-dialog").css({left:"0px",top:"0px",width:r.width+"px",height:r.height+"px",position:r.position});this.element.height(r.contentHeight);t.removeClass("mobile-layout");this.element.removeData("responsiveData")}}};n=i=__decorate([e.Decorators.registerClass([e.IDialog])],n);return n;var i}(e.TemplatedWidget);e.TemplatedDialog=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(t){__extends(n,t);function n(){var n=t.call(this)||this;new e.QuickSearchInput(n.byId("Search"),{onSearch:function(e,t,i){t=Q.trimToNull(t);if(t!=null)t=Select2.util.stripDiacritics(t.toLowerCase());n.element.find("li").each(function(e,n){$(n).toggle(!t||Select2.util.stripDiacritics($(n).text().toLowerCase()).indexOf(t)>=0)})}});n.ulVisible=n.byId("VisibleCols");n.ulHidden=n.byId("HiddenCols");return n}n.createToolButton=function(t){function n(){var n=new e.ColumnPickerDialog;n.allColumns=t.allColumns;if(t.initialSettings){var i=t.initialSettings;if(i.columns&&i.columns.length)n.defaultColumns=i.columns.map(function(e){return e.id})}n.visibleColumns=t.slickGrid.getColumns().map(function(e){return e.id});n.done=function(){t.allColumns=n.allColumns;var e=n.allColumns.filter(function(e){return e.visible===true});t.slickGrid.setColumns(e);t.persistSettings();t.refresh()};Q.Router.dialog(t.element,n.element,function(){return"columns"});n.dialogOpen()}t.element.on("handleroute."+t.uniqueName,function(e,t){if(t&&!t.handled&&t.route=="columns"){n()}});return{hint:Q.text("Controls.ColumnPickerDialog.Title"),cssClass:"column-picker-button",onClick:n}};n.prototype.getDialogOptions=function(){var e=this;var n=t.prototype.getDialogOptions.call(this);n.title=Q.text("Controls.ColumnPickerDialog.Title");n.width=600;n.buttons=[{text:Q.text("Controls.ColumnPickerDialog.RestoreDefaults"),click:function(){var t={};e.ulVisible.children().add(e.ulHidden.children()).each(function(e,n){var i=$(n);t[i.data("key")]=i});var n=null;for(var i=0,r=e.defaultColumns;i<r.length;i++){var a=r[i];var o=t[a];if(!o)continue;if(n==null)o.prependTo(e.ulVisible);else o.insertAfter(n);n=o;var s=o.data("key");delete t[s]}for(var s in t)t[s].appendTo(e.ulHidden);e.updateListStates()}},{text:Q.text("Dialogs.OkButton"),click:function(){var t=[];for(var n=0,i=e.allColumns;n<i.length;n++){var r=i[n];r.visible=false}e.visibleColumns=e.ulVisible.children().toArray().map(function(n){var i=$(n).data("key");var r=e.colById[i];r.visible=true;t.push(r);return i});for(var a=0,o=e.allColumns;a<o.length;a++){var r=o[a];if(!r.visible)t.push(r)}e.allColumns=t;e.done&&e.done();e.dialogClose()}},{text:Q.text("Dialogs.CancelButton"),click:function(){e.dialogClose()}}];return n};n.prototype.getTitle=function(e){if(e.id=="__select__")return"[x]";return e.name||e.toolTip||e.id};n.prototype.createLI=function(e){return $('\n<li data-key="'+e.id+'">\n  <span class="drag-handle">☰</span>\n  '+Q.htmlEncode(this.getTitle(e))+'\n  <i class="js-hide" title="'+Q.text("Controls.ColumnPickerDialog.HideHint")+'">✖</i>\n  <i class="js-show fa fa-eye" title="'+Q.text("Controls.ColumnPickerDialog.ShowHint")+'"></i>\n</li>')};n.prototype.updateListStates=function(){this.ulVisible.children().removeClass("bg-info").addClass("bg-success");this.ulHidden.children().removeClass("bg-success").addClass("bg-info")};n.prototype.setupColumns=function(){var e=this;this.allColumns=this.allColumns||[];this.visibleColumns=this.visibleColumns||[];var t={};for(var n=0,i=this.visibleColumns;n<i.length;n++){var r=i[n];t[r]=true}this.colById={};for(var a=0,o=this.allColumns;a<o.length;a++){var s=o[a];this.colById[s.id]=s}if(this.defaultColumns==null)this.defaultColumns=this.visibleColumns.slice(0);var l=[];for(var u=0,c=this.allColumns;u<c.length;u++){var f=c[u];if(!t[f.id]&&(!f.sourceItem||f.sourceItem.filterOnly!==true&&(f.sourceItem.readPermission==null||Q.Authorization.hasPermission(f.sourceItem.readPermission)))){l.push(f)}}var d=l.sort(function(t,n){return Q.turkishLocaleCompare(e.getTitle(t),e.getTitle(n))});for(var g=0,p=this.visibleColumns;g<p.length;g++){var r=p[g];var h=this.colById[r];if(!h)continue;this.createLI(h).appendTo(this.ulVisible)}for(var v=0,m=d;v<m.length;v++){var y=m[v];
this.createLI(y).appendTo(this.ulHidden)}this.updateListStates();if(typeof Sortable!=="undefined"&&Sortable.create){Sortable.create(this.ulVisible[0],{group:this.uniqueName+"_group",filter:".js-hide",onFilter:function(t){$(t.item).appendTo(e.ulHidden);e.updateListStates()},onEnd:function(t){return e.updateListStates()}});Sortable.create(this.ulHidden[0],{group:this.uniqueName+"_group",sort:false,filter:".js-show",onFilter:function(t){$(t.item).appendTo(e.ulVisible);e.updateListStates()},onEnd:function(t){return e.updateListStates()}})}};n.prototype.onDialogOpen=function(){t.prototype.onDialogOpen.call(this);this.element.find("input").removeAttr("disabled");this.element.closest(".ui-dialog").children(".ui-dialog-buttonpane").find("button").eq(0).addClass("restore-defaults").next().focus();this.setupColumns();Q.centerDialog(this.element)};n.prototype.getTemplate=function(){return'\n<div class="search"><input id="~_Search" type="text" disabled /></div>\n<div class="columns-container">\n<div class="column-list visible-list bg-success">\n  <h5><i class="fa fa-eye"></i> '+Q.text("Controls.ColumnPickerDialog.VisibleColumns")+'</h5>\n  <ul id="~_VisibleCols"></ul>\n</div>\n<div class="column-list hidden-list bg-info">\n  <h5><i class="fa fa-list"></i> '+Q.text("Controls.ColumnPickerDialog.HiddenColumns")+'</h5>\n  <ul id="~_HiddenCols"></ul>\n</div>\n</div>'};n=__decorate([e.Decorators.registerClass(),e.Decorators.resizable(),e.Decorators.responsive()],n);return n}(e.TemplatedDialog);e.ColumnPickerDialog=t})(Serenity||(Serenity={}));var Serenity;(function(e){var t=function(){function t(n){this.options=n;var i=this.dataGrid=n.grid;var r=i.getIdProperty();var a=this.getId=function(e){return e[r]};i.element.find(".grid-container").on("click",function(t){if($(t.target).hasClass("s-TreeToggle")){var n=i.slickGrid.getCellFromEvent(t);if(n.cell>=0&&n.row>=0){e.SlickTreeHelper.toggleClick(t,n.row,n.row,i.view,a)}}});var o=i.onViewFilter;i.onViewFilter=function(t){if(!o.apply(this,[t]))return false;return e.SlickTreeHelper.filterById(t,i.view,n.getParentId)};var s=i.onViewProcessData;i.onViewProcessData=function(i){i=s.apply(this,[i]);i.Entities=t.applyTreeOrdering(i.Entities,a,n.getParentId);e.SlickTreeHelper.setIndents(i.Entities,a,n.getParentId,n.initialCollapse&&n.initialCollapse()||false);return i};if(n.toggleField){var l=Q.first(i.getGrid().getColumns(),function(e){return e.field==n.toggleField});l.format=e.SlickFormatting.treeToggle(function(){return i.view},a,l.format||function(e){return Q.htmlEncode(e.value)});l.formatter=e.SlickHelper.convertToFormatter(l.format)}}t.prototype.toggleAll=function(){e.SlickTreeHelper.setCollapsed(this.dataGrid.view.getItems(),!this.dataGrid.view.getItems().every(function(e){return e._collapsed==true}));this.dataGrid.view.setItems(this.dataGrid.view.getItems(),true)};t.applyTreeOrdering=function(e,t,n){var i=[];var r=Q.toGrouping(e,t);var a=Q.toGrouping(e,n);var o={};function s(e){if(o[e])return;o[e]=true;for(var n=0,r=a[e]||[];n<r.length;n++){var l=r[n];i.push(l);s(t(l))}}for(var l=0,u=e;l<u.length;l++){var c=u[l];var f=n(c);if(f==null||!(r[f]||[]).length){i.push(c);s(t(c))}}return i};return t}();e.TreeGridMixin=t})(Serenity||(Serenity={}));if($.fn.button&&$.fn.button.noConflict){var btn=$.fn.button.noConflict();$.fn.btn=btn}$.fn.flexHeightOnly=function(e){if(e===void 0){e=1}return this.flexWidthHeight(0,e)};$.fn.flexWidthOnly=function(e){if(e===void 0){e=1}return this.flexWidthHeight(e,0)};$.fn.flexWidthHeight=function(e,t){if(e===void 0){e=1}if(t===void 0){t=1}return this.addClass("flexify").data("flex-x",e).data("flex-y",t)};$.fn.flexX=function(e){return this.data("flex-x",e)};$.fn.flexY=function(e){return this.data("flex-y",e)};if($.fn.button&&$.fn.button.noConflict){var btn=$.fn.button.noConflict();$.fn.btn=btn}(function(e){e.widget("ui.slickPager",{options:{view:null,showRowsPerPage:true,rowsPerPageOptions:[20,100,500,2e3],onRpChange:null},_create:function(){var t=this;var n=t.options;var i=n.view;if(!i)throw"SlickPager requires view option to be set!";this.element.addClass("s-SlickPager slick-pg").html('<div class="slick-pg-in">'+'<div class="slick-pg-grp">'+'<div class="slick-pg-first slick-pg-btn"><span class="slick-pg-btn-span"></span></div>'+'<div class="slick-pg-prev slick-pg-btn"><span class="slick-pg-btn-span"></span></div>'+'</div><div class="slick-pg-sep"></div><div class="slick-pg-grp">'+'<span class="slick-pg-control">&nbsp;'+Q.text("Controls.Pager.Page")+'&nbsp;<input class="slick-pg-current" type="text" size="4" value="1" /> / '+'<span class="slick-pg-total"> 1 </span></span>'+'</div><div class="slick-pg-sep"></div><div class="slick-pg-grp">'+'<div class="slick-pg-next slick-pg-btn"><span class="slick-pg-btn-span"></span></div>'+'<div class="slick-pg-last slick-pg-btn"><span class="slick-pg-btn-span"></span></div>'+'</div><div class="slick-pg-sep"></div><div class="slick-pg-grp">'+'<div class="slick-pg-reload slick-pg-btn"><span class="slick-pg-btn-span"></span></div>'+'</div><div class="slick-pg-sep"></div>'+'<div class="slick-pg-grp"><span class="slick-pg-stat"></span></div></div>');e(".slick-pg-reload",this.element).click(function(){i.populate()});e(".slick-pg-first",this.element).click(function(){t._changePage("first")});e(".slick-pg-prev",this.element).click(function(){t._changePage("prev")});e(".slick-pg-next",this.element).click(function(){t._changePage("next")});e(".slick-pg-last",this.element).click(function(){t._changePage("last")});e(".slick-pg-current",this.element).keydown(function(e){if(e.keyCode==13)t._changePage("input")});if(t.options.showRowsPerPage){var r,a="";for(var o=0;o<n.rowsPerPageOptions.length;o++){if(i.rowsPerPage==n.rowsPerPageOptions[o])a='selected="selected"';else a="";r+="<option value='"+n.rowsPerPageOptions[o]+"' "+a+" >"+n.rowsPerPageOptions[o]+"&nbsp;&nbsp;</option>"}e(".slick-pg-in",this.element).prepend('<div class="slick-pg-grp"><select class="slick-pg-size" name="rp">'+r+'</select></div><div class="slick-pg-sep"></div>');e("select.slick-pg-size",this.element).change(function(){if(n.onRowsPerPageChange)n.onRowsPerPageChange(+this.value);else{i.newp=1;i.setPagingOptions({page:1,rowsPerPage:+this.value})}})}i.onPagingInfoChanged.subscribe(function(){t._updatePager()})},destroy:function(){e.Widget.prototype.destroy.apply(this,arguments)},_changePage:function(t){var n=this.options.view;if(!n||n.loading)return true;var i=n.getPagingInfo();var r=!i.rowsPerPage||!i.totalCount?1:Math.ceil(i.totalCount/i.rowsPerPage);var a;switch(t){case"first":a=1;break;case"prev":if(i.page>1)a=parseInt(i.page)-1;break;case"next":if(i.page<r)a=parseInt(i.page)+1;break;case"last":a=r;break;case"input":var o=parseInt(e("input.slick-pg-current",this.element).val());if(isNaN(o))o=1;else if(o<1)o=1;else if(o>r)o=r;e(".slick-pg-current",this.element).val(o);a=o;break}if(a==i.page)return false;if(this.options.onChangePage)this.options.onChangePage(a);else{n.setPagingOptions({page:a})}},_updatePager:function(){var t=this.options.view;var n=t.getPagingInfo();var i=!n.rowsPerPage||!n.totalCount?1:Math.ceil(n.totalCount/n.rowsPerPage);e(".slick-pg-current",this.element).val(n.page);e(".slick-pg-total",this.element).html(i);var r=(n.page-1)*n.rowsPerPage+1;var a=r+n.rowsPerPage-1;if(n.totalCount<a)a=n.totalCount;var o;if(n.loading){o=Q.text("Controls.Pager.LoadingStatus")}else if(n.error){o=n.error}else if(n.totalCount>0){o=Q.text("Controls.Pager.PageStatus");o=o.replace(/{from}/,r);o=o.replace(/{to}/,a);o=o.replace(/{total}/,n.totalCount)}else o=Q.text("Controls.Pager.NoRowStatus");e(".slick-pg-stat",this.element).html(o);e(".slick-pg-size",this.element).val((n.rowsPerPage||0).toString())},_setOption:function(t,n){e.Widget.prototype._setOption.apply(this,arguments)}})})(jQuery);var Slick;(function(e){var t;(function(e){var t})(t=e.Data||(e.Data={}))})(Slick||(Slick={}));(function(e){var t=function(){function t(t){var n=this;var i={groupItemMetadataProvider:null,inlineFilters:false};var r;var a=[];var o=[];var s={};var l=null;var u=null;var c=null;var f=0;var d=true;var g;var p;var h={};var v={};var m;var y=[];var b;var w;var C=[];var _={getter:null,formatter:null,comparer:function(e,t){return e.value===t.value?0:e.value>t.value?1:-1},predefinedValues:[],aggregateEmpty:false,aggregateCollapsed:false,aggregateChildGroups:false,collapsed:false,displayTotalsRow:true,lazyTotalsCalculation:false};var x={};var S=[];var T=[];var A=[];var P=":|:";var k=1;var D=0;var I=new e.Event;var O=new e.Event;var E=new e.Event;var N=false;var F=null;var R=0;var M=0;var H;var z;var j=null;var V=new e.Event;var L=new e.Event;var q=new e.Event;var B=new e.Event;var U;function W(){f++}function G(){f--;if(f<=0)Kt()}function K(e){h=e}function J(e){m=e}function Z(e){e=e||0;var t;for(var n=e,i=a.length;n<i;n++){t=a[n][r];if(t===undefined){var o="Each data element must implement a unique '"+r+"' property. Object at index '"+n+"' "+"has no identity value: ";o+=$.toJSON(a[n]);throw o}s[t]=n}}function Y(){var e;for(var t=0,n=a.length;t<n;t++){e=a[t][r];if(e===undefined||s[e]!==t){var i="Each data element must implement a unique '"+r+"' property. Object at index '"+t+"' ";if(e==undefined)i+="has no identity value: ";else i+="has repeated identity value '"+e+"': ";i+=$.toJSON(a[t]);throw i}}}function X(){return a}function et(e){a=y=e;s={};l=null;x.totals={};Z();Y();if(f){Gt(a)}else{Kt()}V.notify({dataView:n},null,n)}function tt(e){var t=false;if(e.rowsPerPage!=undefined&&U.rowsPerPage!=e.rowsPerPage){U.rowsPerPage=e.rowsPerPage;t=true}if(e.page!=undefined){var n;if(!U.rowsPerPage)n=1;else if(j==null)n=e.page;else n=Math.min(e.page,Math.ceil(j/U.rowsPerPage)+1);if(n<1)n=1;if(n!=k){U.seekToPage=n;t=true}}if(t)Xt()}function nt(){return{rowsPerPage:U.rowsPerPage,page:k,totalCount:j,loading:N,error:F,dataView:n}}function it(e,t){d=t;p=e;g=null;if(t===false){a.reverse()}a.sort(e);if(t===false){a.reverse()}s={};Z();Kt()}function rt(e,t){d=t;g=e;p=null;var n=Object.prototype.toString;Object.prototype.toString=typeof e==="function"?e:function(){return this[e]};if(t===false){a.reverse()}a.sort();Object.prototype.toString=n;if(t===false){a.reverse()}s={};Z();Kt()}function at(){if(p){it(p,d)}else if(g){rt(g,d)}}function ot(e){u=e;if(t.inlineFilters){b=Vt();w=Lt()}Kt()}function st(){return S}function lt(e){e=e||{};x.aggregators=e.aggregators||[];x.compiledAccumulators=[];x.totals={};var t=x.aggregators.length;while(t--){x.compiledAccumulators[t]=jt(x.aggregators[t])}ct(S||[])}function ut(){x.totals=x.totals||{};if(!x.totals.initialized){x.aggregators=x.aggregators||[];x.compiledAccumulators=x.compiledAccumulators||[];var e,t=x.aggregators.length;while(t--){e=x.aggregators[t];e.init();x.compiledAccumulators[t].call(e,a);e.storeResult(x.totals)}x.totals.initialized=true}return x.totals}function ct(n){if(!t.groupItemMetadataProvider){t.groupItemMetadataProvider=new e.Data.GroupItemMetadataProvider}T=[];A=[];n=n||[];S=n instanceof Array?n:[n];for(var i=0;i<S.length;i++){var r=S[i]=$.extend(true,{},_,S[i]);r.aggregators=r.aggregators||x.aggregators||[];r.getterIsAFn=typeof r.getter==="function";r.compiledAccumulators=[];var a=r.aggregators.length;while(a--){r.compiledAccumulators[a]=jt(r.aggregators[a])}A[i]={}}Kt()}function ft(e){return a[e]}function dt(e){return s[e]}function gt(){if(!l){l={};for(var e=0,t=o.length;e<t;e++){l[o[e][r]]=e}}}function pt(e){gt();return l[e]}function ht(e){return a[s[e]]}function vt(e){var t=[];gt();for(var n=0,i=e.length;n<i;n++){var r=l[e[n]];if(r!=null){t[t.length]=r}}return t}function mt(e){var t=[];for(var n=0,i=e.length;n<i;n++){if(e[n]<o.length){t[t.length]=o[e[n]][r]}}return t}function yt(e,t){if(s[e]===undefined||e!==t[r]){throw"Invalid or non-matching id"}a[s[e]]=t;if(!c){c={}}c[e]=true;Kt()}function bt(e,t){a.splice(e,0,t);Z(e);Kt()}function wt(e){a.push(e);Z(a.length-1);Kt()}function Ct(e){var t=s[e];if(t===undefined){throw"Invalid id"}delete s[e];a.splice(t,1);Z(t);Kt()}function _t(){return o}function $t(){return o.length}function xt(e){var t=o[e];if(t&&t.__group&&t.totals&&!t.totals.initialized){var n=S[t.level];if(!n.displayTotalsRow){Ft(t.totals);t.title=n.formatter?n.formatter(t):t.value}}else if(t&&t.__groupTotals&&!t.initialized){Ft(t)}return t}function St(e){var n=o[e];if(n===undefined){return null}if(n.__group){return t.groupItemMetadataProvider.getGroupRowMetadata(n)}if(n.__groupTotals){return t.groupItemMetadataProvider.getTotalsRowMetadata(n)}return t.getItemMetadata&&t.getItemMetadata(n,e)||null}function Tt(e,t){if(e==null){for(var n=0;n<S.length;n++){A[n]={};S[n].collapsed=t}}else{A[e]={};S[e].collapsed=t}Kt()}function At(e){Tt(e,true)}function Pt(e){Tt(e,false)}function kt(e){var t=e[0];if(e.length===1&&t.indexOf(P)!==-1){return{level:t.split(P).length-1,groupingKey:t}}else{return{level:e.length-1,groupingKey:e.join(P)}}}function Dt(e,t){var n=kt(e);A[n.level][n.groupingKey]=S[n.level].collapsed^t;Kt()}function It(e){var t=Array.prototype.slice.call(arguments);Dt(t,true)}function Ot(e){var t=Array.prototype.slice.call(arguments);Dt(t,false)}function Et(){return T}function Nt(t,n,i,r,a){var o=t[n];if(!o){o=new e.Group;o.value=n;o.level=i;o.groupingKey=(r?r.groupingKey+P:"")+n;a[a.length]=o;t[n]=o}return o}function Qt(e,t){var n;var i;var r=[];var a={};var o;var s=t?t.level+1:0;var l=S[s];for(var u=0,c=l.predefinedValues.length;u<c;u++){i=l.predefinedValues[u];n=Nt(a,i,s,t,r)}for(var u=0,c=e.length;u<c;u++){o=e[u];i=l.getterIsAFn?l.getter(o):o[l.getter];n=Nt(a,i,s,t,r);n.rows[n.count++]=o}if(s<S.length-1){for(var u=0;u<r.length;u++){n=r[u];n.groups=Qt(n.rows,n)}}r.sort(S[s].comparer);return r}function Ft(e){var t=e.group;var n=S[t.level];var i=t.level==S.length;var r,a=n.aggregators.length;if(!i&&n.aggregateChildGroups){var o=t.groups.length;while(o--){if(!t.groups[o].totals.initialized){Ft(t.groups[o].totals)}}}while(a--){r=n.aggregators[a];r.init();if(!i&&n.aggregateChildGroups){n.compiledAccumulators[a].call(r,t.groups)}else{n.compiledAccumulators[a].call(r,t.rows)}r.storeResult(e)}e.initialized=true}function Rt(t){var n=S[t.level];var i=new e.GroupTotals;i.group=t;t.totals=i;if(!n.lazyTotalsCalculation){Ft(i)}}function Mt(e,t){t=t||0;var n=S[t];var i=n.collapsed;var r=A[t];var a=e.length,o;while(a--){o=e[a];if(o.collapsed&&!n.aggregateCollapsed){continue}if(o.groups){Mt(o.groups,t+1)}if(n.aggregators.length&&(n.aggregateEmpty||o.rows.length||o.groups&&o.groups.length)){Rt(o)}o.collapsed=i^r[o.groupingKey];o.title=n.formatter?n.formatter(o):o.value}}function Ht(e,t){t=t||0;var n=S[t];var i=[],r,a=0,o;for(var s=0,l=e.length;s<l;s++){o=e[s];i[a++]=o;if(!o.collapsed){r=o.groups?Ht(o.groups,t+1):o.rows;for(var u=0,c=r.length;u<c;u++){i[a++]=r[u]}}if(o.totals&&n.displayTotalsRow&&(!o.collapsed||n.aggregateCollapsed)){i[a++]=o.totals}}return i}function zt(e){var t=/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/;var n=e.toString().match(t);return{params:n[1].split(","),body:n[2]}}function jt(e){var t=zt(e.accumulate);var n=new Function("_items","for (var "+t.params[0]+", _i=0, _il=_items.length; _i<_il; _i++) {"+t.params[0]+" = _items[_i]; "+t.body+"}");n.displayName=n.name="compiledAccumulatorLoop";return n}function Vt(){var e=zt(u);var t=e.body.replace(/return false\s*([;}]|$)/gi,"{ continue _coreloop; }$1").replace(/return true\s*([;}]|$)/gi,"{ _retval[_idx++] = $item$; continue _coreloop; }$1").replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2");var n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");n=n.replace(/\$filter\$/gi,t);n=n.replace(/\$item\$/gi,e.params[0]);n=n.replace(/\$args\$/gi,e.params[1]);var i=new Function("_items,_args",n);i.displayName=i.name="compiledFilter";return i}function Lt(){var e=zt(u);var t=e.body.replace(/return false\s*([;}]|$)/gi,"{ continue _coreloop; }$1").replace(/return true\s*([;}]|$)/gi,"{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1").replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2");var n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");n=n.replace(/\$filter\$/gi,t);n=n.replace(/\$item\$/gi,e.params[0]);n=n.replace(/\$args\$/gi,e.params[1]);var i=new Function("_items,_args,_cache",n);i.displayName=i.name="compiledFilterWithCaching";return i}function qt(e,t){var n=[],i=0;for(var r=0,a=e.length;r<a;r++){if(u(e[r],t)){n[i++]=e[r]}}return n}function Bt(e,t,n){var i=[],r=0,a;for(var o=0,s=e.length;o<s;o++){a=e[o];if(n[o]){i[r++]=a}else if(u(a,t)){i[r++]=a;n[o]=true}}return i}function Ut(e){if(u){var n=t.inlineFilters?b:qt;var i=t.inlineFilters?w:Bt;if(h.isFilterNarrowing){y=n(y,m)}else if(h.isFilterExpanding){y=i(e,m,C)}else if(!h.isFilterUnchanged){y=n(e,m)}}else{y=e.concat()}return{totalRows:y.length,rows:y}}function Wt(e,t){var n,i,a,o=[];var s=0,l=t.length;if(h&&h.ignoreDiffsBefore){s=Math.max(0,Math.min(t.length,h.ignoreDiffsBefore))}if(h&&h.ignoreDiffsAfter){l=Math.min(t.length,Math.max(0,h.ignoreDiffsAfter))}for(var u=s,f=e.length;u<l;u++){if(u>=f){o[o.length]=u}else{n=t[u];i=e[u];if(S.length&&(a=n.__nonDataRow||i.__nonDataRow)&&n.__group!==i.__group||n.__group&&!n.equals(i)||a&&(n.__groupTotals||i.__groupTotals)||n[r]!=i[r]||c&&c[n[r]]){o[o.length]=u}}}return o}function Gt(e){l=null;if(h.isFilterNarrowing!=v.isFilterNarrowing||h.isFilterExpanding!=v.isFilterExpanding){C=[]}var t=Ut(e);D=t.totalRows;var n=t.rows;x.totals={};T=[];if(S.length){T=Qt(n);if(T.length){Mt(T);n=Ht(T)}}var i=Wt(o,n);o=n;return i}function Kt(){if(f){return}var e=o.length;var t=D;var i=Gt(a);c=null;v=h;h={};if(t!==D){E.notify(nt(),null,n)}if(e!==o.length){I.notify({previous:e,current:o.length,dataView:n},null,n)}if(i.length>0){O.notify({rows:i,dataView:n},null,n)}}function Jt(t,n,i){var r=this;var a;var o=r.mapRowsToIds(t.getSelectedRows());var s=new e.Event;function l(n){if(o.join(",")==n.join(",")){return}o=n;s.notify({grid:t,ids:o,dataView:r},new e.EventData,r)}function u(){if(o.length>0){a=true;var e=r.mapIdsToRows(o);if(!n){l(r.mapRowsToIds(e))}t.setSelectedRows(e);a=false}}t.onSelectedRowsChanged.subscribe(function(e,n){if(a){return}var s=r.mapRowsToIds(t.getSelectedRows());if(!i||!t.getOptions().multiSelect){l(s)}else{var u=$.grep(o,function(e){return r.getRowById(e)===undefined});l(u.concat(s))}});this.onRowsChanged.subscribe(u);this.onRowCountChanged.subscribe(u);return s}function Zt(e,t){var n;var i;a(e.getCellCssStyles(t));function a(e){n={};for(var t in e){var i=o[t][r];n[i]=e[t]}}function s(){if(n){i=true;gt();var r={};for(var a in n){var o=l[a];if(o!=undefined){r[o]=n[a]}}e.setCellCssStyles(t,r);i=false}}e.onCellCssStylesChanged.subscribe(function(e,n){if(i){return}if(t!=n.key){return}if(n.hash){a(n.hash)}});this.onRowsChanged.subscribe(s);this.onRowCountChanged.subscribe(s)}function Yt(e){if(U.onProcessData&&e)e=U.onProcessData(e,U)||e;F=null;N&&N.abort();N=false;if(!e){F=U.errormsg;E.notify(nt());return false}var t=e;e.TotalCount=e.TotalCount||0;e.Entities=e.Entities||[];if(!e.Skip||!U.rowsPerPage&&!e.Take)e.Page=1;else e.Page=Math.ceil(e.Skip/(e.Take||U.rowsPerPage))+1;k=e.Page;j=e.TotalCount;et(e.Entities);E.notify(nt())}function Xt(){if(R>0){M++;return}M=0;N&&N.abort();if(U.onSubmit){var e=U.onSubmit(U);if(e===false)return false}L.notify(this);if(!U.url)return false;if(!U.seekToPage)U.seekToPage=1;var t={};var n=(U.seekToPage-1)*U.rowsPerPage;if(n)t.Skip=n;if(U.rowsPerPage)t.Take=U.rowsPerPage;if(U.sortBy&&U.sortBy.length){if($.isArray(U.sortBy))t.Sort=U.sortBy;else{t.Sort=[U.sortBy]}}if(U.params){t=$.extend(t,U.params)}var i=z;var r=this;var a={cache:false,type:U.method,contentType:H,url:U.url,data:t,dataType:i,success:function(e){N=false;if(e.Error)Q.notifyError(e.Error.Message||e.Error.Code);else Yt(e);q.notify(this)},error:function(e,t,n){N=false;if((e.getResponseHeader("content-type")||"").toLowerCase().indexOf("application/json")>=0){var i=$.parseJSON(e.responseText);if(i!=null&&i.Error!=null){Q.notifyError(i.Error.Message||i.Error.Code);E.notify(nt());q.notify(this);return}}F=e.errormsg;E.notify(nt());q.notify(this)},complete:function(){N=false}};if(U.onAjaxCall){var o=U.onAjaxCall(this,a);if(o===false){N=false;E.notify(nt());return false}}a.data=$.toJSON(a.data);E.notify(nt());N=$.ajax(a)}function en(){if(R==0)M=0;R++}function tn(){if(R>0){R--;if(R==0&&M>0)Xt()}}U={beginUpdate:W,endUpdate:G,setPagingOptions:tt,getPagingInfo:nt,getRows:_t,getItems:X,setItems:et,setFilter:ot,sort:it,fastSort:rt,reSort:at,setSummaryOptions:lt,getGrandTotals:ut,setGrouping:ct,getGrouping:st,collapseAllGroups:At,expandAllGroups:Pt,collapseGroup:It,expandGroup:Ot,getGroups:Et,getIdxById:dt,getRowById:pt,getItemById:ht,getItemByIdx:ft,mapRowsToIds:mt,mapIdsToRows:vt,setRefreshHints:K,setFilterArgs:J,refresh:Kt,updateItem:yt,insertItem:bt,addItem:wt,deleteItem:Ct,syncGridSelection:Jt,syncGridCellCssStyles:Zt,getLength:$t,getItem:xt,getItemMetadata:St,onRowCountChanged:I,onRowsChanged:O,onPagingInfoChanged:E,addData:Yt,populate:Xt,populateLock:en,populateUnlock:tn,onDataChanged:V,onDataLoaded:q,onDataLoading:L};r=t.idField||"id";H=t.contentType||"application/json";z=t.dataType||"json";u=t.filter||null;U.params=t.params||{};U.onSubmit=t.onSubmit||null;U.url=t.url||null;U.rowsPerPage=t.rowsPerPage||0;U.seekToPage=t.seekToPage||1;U.onAjaxCall=t.onAjaxCall||null;U.onProcessData=t.onProcessData||null;U.method=t.method||"POST";U.errormsg=U.errormsg||Q.text("Controls.Pager.DefaultLoadError");U.sortBy=t.sortBy||[];U.idField=r;if(t.url&&t.autoLoad){Xt()}return U}return t}();e.RemoteView=t})(Slick||(Slick={}));(function(e){var t;(function(e){function t(e){this.field_=e;this.init=function(){this.count_=0;this.nonNullCount_=0;this.sum_=0};this.accumulate=function(e){var t=e[this.field_];this.count_++;if(t!=null&&t!==""&&!isNaN(t)){this.nonNullCount_++;this.sum_+=parseFloat(t)}};this.storeResult=function(e){if(!e.avg){e.avg={}}if(this.nonNullCount_!=0){e.avg[this.field_]=this.sum_/this.nonNullCount_}}}e.Avg=t;function n(e,t){this.field_=e;this.weightedField_=t;this.init=function(){this.sum_=0;this.weightedSum_=0};this.accumulate=function(e){var t=e[this.field_];var n=e[this.weightedField_];if(this.isValid(t)&&this.isValid(n)){this.weightedSum_+=parseFloat(n);this.sum_+=parseFloat(t)*parseFloat(n)}};this.storeResult=function(e){if(!e.avg){e.avg={}}if(this.sum_&&this.weightedSum_){e.avg[this.field_]=this.sum_/this.weightedSum_}};this.isValid=function(e){return e!==null&&e!==""&&!isNaN(e)}}e.WeightedAvg=n;function i(e){this.field_=e;this.init=function(){this.min_=null};this.accumulate=function(e){var t=e[this.field_];if(t!=null&&t!==""&&!isNaN(t)){if(this.min_==null||t<this.min_){this.min_=t}}};this.storeResult=function(e){if(!e.min){e.min={}}e.min[this.field_]=this.min_}}e.Min=i;function r(e){this.field_=e;this.init=function(){this.max_=null};this.accumulate=function(e){var t=e[this.field_];if(t!=null&&t!==""&&!isNaN(t)){if(this.max_==null||t>this.max_){this.max_=t}}};this.storeResult=function(e){if(!e.max){e.max={}}e.max[this.field_]=this.max_}}e.Max=r;function a(e){this.field_=e;this.init=function(){this.sum_=null};this.accumulate=function(e){var t=e[this.field_];if(t!=null&&t!==""&&!isNaN(t)){this.sum_+=parseFloat(t)}};this.storeResult=function(e){if(!e.sum){e.sum={}}e.sum[this.field_]=this.sum_}}e.Sum=a})(t=e.Aggregators||(e.Aggregators={}))})(Slick||(Slick={}));var Q;(function(e){var t;function n(e,n){t.call(this,e,n);this.errorsFor(e).each(function(t,n){if($(e).hasClass("error"))$(n).removeClass("checked");$(n).attr("title",$(n).text())})}function i(){if($.validator.methods["customValidate"]==null){$.validator.addMethod("customValidate",function(e,t){var n=this.optional(t);if(t==null||!!n){return n}var i=$._data(t,"events");if(!i){return true}var r=i.customValidate;if(r==null||r.length===0){return true}var a=$(t);for(var o=0;!!(o<r.length);o++){var s=ss.safeCast(r[o].handler,Function);if(s){var l=s(a);if(l!=null){a.data("customValidationMessage",l);return false}}}return true},function(e,t){return $(t).data("customValidationMessage")})}}function r(){i();var r=$.validator;r=r.prototype;t=r.showLabel;r.showLabel=n;$.validator.addMethod("dateQ",function(t,n){var i=this.optional(n);if(i)return i;var r=e.parseDate(t);if(!r)return false;var a=new Date(r);a.setHours(0,0,0,0);return a.getTime()===r.getTime()});$.validator.addMethod("hourAndMin",function(t,n){return this.optional(n)||!isNaN(e.parseHourAndMin(t))});$.validator.addMethod("dayHourAndMin",function(t,n){return this.optional(n)||!isNaN(e.parseDayHourAndMin(t))});$.validator.addMethod("decimalQ",function(t,n){return this.optional(n)||!isNaN(e.parseDecimal(t))});$.validator.addMethod("integerQ",function(t,n){return this.optional(n)||!isNaN(e.parseInteger(t))});var a=$.validator.methods["email"];$.validator.addMethod("email",function(t,n){if(!e.Config.emailAllowOnlyAscii)return a.call(this,t,n);return this.optional(n)||/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)});$.validator.addMethod("emailMultiple",function(e,t){var n=this.optional(t);if(n)return n;if(e.indexOf(";")>=0)e=e.split(";");else e=e.split(",");for(var i=0;i<e.length;i++){n=$.validator.methods["email"].call(this,e[i],t);if(!n)return n}return n});$.validator.addMethod("anyvalue",function(e,t){return true});var o=$.validator.defaults;o.ignoreTitle=true;o.onchange=function(e){this.element(e)};r.oldinit=r.init;r.init=function(){r.oldinit.call(this);function e(e){if(this.form==null)return;var t=$.data(this.form,"validator"),n="on"+e.type.replace(/^validate/,"");t&&t.settings[n]&&t.settings[n].call(t,this)}function t(t){var n=this[0];if(!$.data(n,"changebound")){$(n).change(e);$.data(n,"changebound",true)}}$(this.currentForm).on(":text, :password, :file, select, textarea","focusin.validate",t)};r.oldfocusInvalid=r.focusInvalid;r.focusInvalid=function(){if(this.settings.abortHandler)this.settings.abortHandler(this);this.oldfocusInvalid.call(this)};r.oldstopRequest=r.focusInvalid;r.stopRequest=function(e,t){var n=this.formSubmitted;this.oldfocusInvalid.call(this,[e,t]);if(!t&&this.pendingRequest==0&&n&&this.settings.abortHandler){this.settings.abortHandler(this)}};r.resetAll=function(){this.submitted={};this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass)};jQuery(function(){$.extend($.validator.messages,{email:e.text("Validation.Email"),required:e.text("Validation.Required"),minlength:e.text("Validation.MinLength"),maxlength:e.text("Validation.MaxLength"),digits:e.text("Validation.Digits"),range:e.text("Validation.Range"),xss:e.text("Validation.Xss"),dateQ:e.text("Validation.DateInvalid"),decimalQ:e.text("Validation.Decimal"),integerQ:e.text("Validation.Integer"),url:e.text("Validation.Url")})})}function a(e){e.settings.abortHandler=null;e.settings.submitHandler=function(){return false}}e.validatorAbortHandler=a;function o(t){return $.extend({ignore:":hidden",meta:"v",errorClass:"error",errorPlacement:function(e,t){var n=null;var i=t.attr("data-vx-id");if(i){n=$("#"+i);if(!n.length)n=null;else n=n[0]}if(n==null){n=t.parents("div.field");if(n.length){var r=$("div.vx",n[0]);if(r.length)n=r[0]}else n=t.parent()}e.appendTo(n)},submitHandler:function(){return false},invalidHandler:function(t,n){e.notifyError(e.text("Validation.InvalidFormMessage"));$(n.errorList.map(function(e){return e.element})).closest(".category.collapsed").children(".category-title").each(function(e,t){$(t).click();return true});if(n.errorList.length){var i=n.errorList[0].element;if(i){var r=$(i).closest(".tab-pane");if(!r.hasClass("active")&&r.parent().hasClass("tab-content")){var a=r.attr("id");if(a){$('a[href="#'+a+'"]').click()}}if($.fn.tooltip){$.fn.tooltip&&$(i).tooltip({title:n.errorList[0].message,trigger:"manual"}).tooltip("show");window.setTimeout(function(){$(i).tooltip("destroy")},1500)}}}},success:function(e){e.addClass("checked")}},t)}e.validateOptions=o;if(window["jQuery"]&&window["jQuery"]["validator"])r();else if(window["jQuery"]){jQuery(function(e){if(e.validator)r()})}function s(){var t=e.Culture.dateOrder;var n=e.Culture.dateSeparator;var i=($("html").attr("lang")||"en").toLowerCase();if(!$.datepicker.regional[i]){i=i.split("-")[0];if(!$.datepicker.regional[i]){i="en"}}$.datepicker.setDefaults($.datepicker.regional["en"]);$.datepicker.setDefaults($.datepicker.regional[i]);$.datepicker.setDefaults({dateFormat:t=="mdy"?"mm"+n+"dd"+n+"yy":t=="ymd"?"yy"+n+"mm"+n+"dd":"dd"+n+"mm"+n+"yy",buttonImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNvyMY98AAAHNSURBVEhLtZU/S8NAGIf7FfpJHDoX136ADp3s4qDgUpeCDlJEEIcubk7ZFJ06OBRcdJAOdhCx6CAWodJFrP8KFexrnhcv3sVLVYyBp/fLXe75hbSkGRFxaLVaEgSBMMbXkpi0Rz8eVlbkrlhUdnM56XQ6Opq57/DtwRkVMCFMhJzn89JoNHQ0c9/h26NOU3BdKMh4eVneFhflcGpK1rNZHTn/CfE9uHA6BSyMFhZkODsrt2E7I+c/Ib4Hl1NwOT0dXcgx2N6Wh+FQx16vp/O/ARdO3FrAs2PhcWZGm3l+9sj8b8Cl34ddwMKgVEoFXE5BUK9zkurx4fwseBuPUyWxYKfZTCQIf+txtvb2HLwFm7WaTg5fX1V0cnWlxPPR2ZmC2GSkB+22QsaBC6dTwMLzaPTnAhy4vhSwcP/yEl1s2D8+ngjFNjhwJRZwt9wB2Jm79WVuws4TC3qDgUrJYGekvozUzjjITsFGtarNpsBw2u0654ghnhEbcODCmVjAewjsjMyXkdo5seDm6Uku+n2VcgHYGakvI7UzDlxOwWql4hT4QOoDqY0pwBkVLM3NRQVpgAtnVFApl3UyTXBGBWvhX9x8+JpNE5xRwf8hmXe+7B9dZrOuOwAAAABJRU5ErkJggg==",buttonImageOnly:true,showOn:"both",showButtonPanel:true,changeMonth:true,changeYear:true})}if(window["jQuery"]&&window["jQuery"]["datepicker"]&&window["jQuery"]["datepicker"]["regional"]&&window["jQuery"]["datepicker"]["regional"]["en"]){s()}else{jQuery(function(e){if(e.datepicker)s()})}function l(){$.ui.dialog.prototype._allowInteraction=function(e){if($(e.target).closest(".ui-dialog").length){return true}return!!$(e.target).closest(".ui-datepicker, .select2-drop, .cke, .cke_dialog, #support-modal").length};(function(e){$.ui.dialog.prototype._focusTabbable=function(){if($(document.body).hasClass("mobile-device")){this.uiDialog&&this.uiDialog.focus();return}e.call(this)}})($.ui.dialog.prototype._focusTabbable);(function(e){$.ui.dialog.prototype._createTitlebar=function(){e.call(this);this.uiDialogTitlebar.find(".ui-dialog-titlebar-close").html('<i class="fa fa-times" />')}})($.ui.dialog.prototype._createTitlebar)}if(jQuery.ui){l()}else{jQuery(function(){if(jQuery.ui)l()})}jQuery.cleanData=function(e){return function(t){var n,i,r,a;var o=t;for(r=0;(i=o[r])!=null;r++){try{n=$._data(i,"events");if(n&&n.remove){if(o===t)o=Array.prototype.slice.call(t);$(i).triggerHandler("remove");delete n.remove}}catch(a){}}e(t)}}(jQuery.cleanData);function u(){ss.Exception.prototype.toString=function(){return this.get_message()}}if(ss&&ss.Exception)u();else{jQuery(function(e){if(ss&&ss.Exception)u()})}function c(){Vue.component("editor",{props:{type:{type:String,required:true},id:{type:String,required:false},name:{type:String,required:false},placeholder:{type:String,required:false},value:{required:false},options:{required:false},maxLength:{required:false}},render:function(e){var t=Serenity.EditorTypeRegistry.get(this.type);var n=ss.getAttributes(t,Serenity.ElementAttribute,true);var i=n.length>0?n[0].value:"<input/>";var r={};var a=$(i)[0];var o=a.attributes;for(var s=0;s<o.length;s++){var l=o.item(s);r[l.name]=l.value}if(this.id!=null)r.id=this.id;if(this.name!=null)r.name=this.name;if(this.placeholder!=null)r.placeholder=this.placeholder;var u=this.options;var c=null;var f=this;var d=e(a.tagName,{domProps:r});this.$editorType=t;return d},watch:{value:function(e){Serenity.EditorUtils.setValue(this.$widget,e)}},mounted:function(){var e=this;this.$widget=new this.$editorType($(this.$el),this.options);
this.$widget.initialize();if(this.maxLength){Serenity.PropertyGrid.$setMaxLength(this.$widget,this.maxLength)}if(this.options)Serenity.ReflectionOptionsSetter.set(this.$widget,this.options);if(this.value!=null)Serenity.EditorUtils.setValue(this.$widget,this.value);if($(this.$el).data("select2"))Serenity.WX.changeSelect2(this.$widget,function(){e.$emit("input",Serenity.EditorUtils.getValue(e.$widget))});else Serenity.WX.change(this.$widget,function(){e.$emit("input",Serenity.EditorUtils.getValue(e.$widget))})},destroyed:function(){if(this.$widget){this.$widget.destroy();this.$widget=null}}})}window["Vue"]?c():$(function(){window["Vue"]&&c()})})(Q||(Q={}));